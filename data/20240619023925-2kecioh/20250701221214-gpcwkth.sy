{"ID":"20250701221214-gpcwkth","Spec":"2","Type":"NodeDocument","Properties":{"id":"20250701221214-gpcwkth","title":"C# 接口和基类（GameFramework中FSM模块）","type":"doc","updated":"20250702042159"},"Children":[{"ID":"20250702025727-ci0mx9f","Type":"NodeParagraph","Properties":{"id":"20250702025727-ci0mx9f","updated":"20250702025821"},"Children":[{"Type":"NodeText","Data":"接口是在基类的基础上的进一步抽象，当需要多继承或统一管理或精简基类的时候就抽象一层接口，如果这层接口还是臃肿，还可以再抽象一层接口。但是当没有以上需求的时候就只使用基类"}]},{"ID":"20250702030106-ij9b42c","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250702030106-ij9b42c","updated":"20250702030127"},"Children":[{"Type":"NodeText","Data":"壹"}]},{"ID":"20250702025718-cx1mrnv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-cx1mrnv","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"一、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接口与基类的本质关系"}]},{"ID":"20250702025718-astcyzs","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"||","id":"20250702025718-astcyzs","updated":"20250702025718"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"维度"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接口（Interface）"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"基类（Base Class）"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"抽象层级"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"更高层抽象（仅契约，无实现）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"次高层抽象（契约 + 部分实现）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"核心作用"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"统一行为规范，支持多继承"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"复用代码逻辑，约束子类行为"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"依赖关系"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"接口可独立存在（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IEnumerable\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"基类常为接口的默认实现（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"List\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​实现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IEnumerable\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​）"}]}]}]},{"ID":"20250702025718-eu8d64d","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-eu8d64d","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"二、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接口的 4 种典型使用场景"}]},{"ID":"20250702025718-ykq4w0s","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702025718-ykq4w0s","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"场景 1：多继承需求"}]},{"ID":"20250702025718-lwe4xrr","Type":"NodeList","ListData":{},"Properties":{"id":"20250702025718-lwe4xrr","updated":"20250702025718"},"Children":[{"ID":"20250702025718-siuydhu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-siuydhu","updated":"20250702025718"},"Children":[{"ID":"20250702025718-u5jr6oj","Type":"NodeParagraph","Properties":{"id":"20250702025718-u5jr6oj","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"问题"},{"Type":"NodeText","Data":"：当一个类需要同时具备多种行为（如 “可移动”+“可攻击”），但基类只能单继承。"}]}]},{"ID":"20250702025718-iefu81g","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-iefu81g","updated":"20250702025718"},"Children":[{"ID":"20250702025718-ct8ugj8","Type":"NodeParagraph","Properties":{"id":"20250702025718-ct8ugj8","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"方案"},{"Type":"NodeText","Data":"：用接口实现多继承：\ncsharp"}]},{"ID":"20250702025718-ol0akgk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-ol0akgk","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IMovable { void Move(); }\npublic interface IAttackable { void Attack(); }\n\npublic class Player : IMovable, IAttackable { ... }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702025718-as3k8ld","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702025718-as3k8ld","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"场景 2：统一管理不同实现"}]},{"ID":"20250702025718-pniuqms","Type":"NodeList","ListData":{},"Properties":{"id":"20250702025718-pniuqms","updated":"20250702025718"},"Children":[{"ID":"20250702025718-n1epip4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-n1epip4","updated":"20250702025718"},"Children":[{"ID":"20250702025718-3ypruhk","Type":"NodeParagraph","Properties":{"id":"20250702025718-3ypruhk","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"问题"},{"Type":"NodeText","Data":"：框架需统一处理不同类型的对象（如支付方式、日志记录器）。"}]}]},{"ID":"20250702025718-kvo1nha","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-kvo1nha","updated":"20250702025718"},"Children":[{"ID":"20250702025718-atxapma","Type":"NodeParagraph","Properties":{"id":"20250702025718-atxapma","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"方案"},{"Type":"NodeText","Data":"：通过接口定义统一契约：\ncsharp"}]},{"ID":"20250702025718-25n34bw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-25n34bw","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IPayment { void Pay(decimal amount); }\n\npublic class Alipay : IPayment { ... }\npublic class WechatPay : IPayment { ... }\n\n// 统一管理\npublic void ProcessPayment(IPayment payment) { ... }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702025718-r4872s9","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702025718-r4872s9","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"3. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"场景 3：精简基类，避免 “上帝类”"}]},{"ID":"20250702025718-qd98c4g","Type":"NodeList","ListData":{},"Properties":{"id":"20250702025718-qd98c4g","updated":"20250702025718"},"Children":[{"ID":"20250702025718-2cbanm7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-2cbanm7","updated":"20250702025718"},"Children":[{"ID":"20250702025718-6x6fvro","Type":"NodeParagraph","Properties":{"id":"20250702025718-6x6fvro","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"问题"},{"Type":"NodeText","Data":"：基类方法过多，违反单一职责原则（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GameObject"},{"Type":"NodeText","Data":"​基类包含渲染、物理、AI 等方法）。"}]}]},{"ID":"20250702025718-q6shily","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-q6shily","updated":"20250702025718"},"Children":[{"ID":"20250702025718-wmyaqwk","Type":"NodeParagraph","Properties":{"id":"20250702025718-wmyaqwk","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"方案"},{"Type":"NodeText","Data":"：将特定功能抽象为接口：\ncsharp"}]},{"ID":"20250702025718-ubynd9q","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-ubynd9q","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IRenderable { void Render(); }\npublic interface IPhysics { void ApplyForce(); }\n\n// 仅需要渲染功能的类实现IRenderable\npublic class StaticObject : IRenderable { ... }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702025718-vqtli2u","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702025718-vqtli2u","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"4. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"场景 4：演进式设计中的扩展点"}]},{"ID":"20250702025718-7t1e5ad","Type":"NodeList","ListData":{},"Properties":{"id":"20250702025718-7t1e5ad","updated":"20250702025718"},"Children":[{"ID":"20250702025718-nus6lmw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-nus6lmw","updated":"20250702025718"},"Children":[{"ID":"20250702025718-oscgqv9","Type":"NodeParagraph","Properties":{"id":"20250702025718-oscgqv9","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"问题"},{"Type":"NodeText","Data":"：初期设计的基类无法预见未来所有扩展（如新增 “可暂停” 功能）。"}]}]},{"ID":"20250702025718-dpxc3jy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-dpxc3jy","updated":"20250702025718"},"Children":[{"ID":"20250702025718-l7wo730","Type":"NodeParagraph","Properties":{"id":"20250702025718-l7wo730","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"方案"},{"Type":"NodeText","Data":"：通过接口新增行为，不修改现有代码：\ncsharp"}]},{"ID":"20250702025718-22h52ac","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-22h52ac","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 新增接口（不改动现有基类）\npublic interface IPausable { void Pause(); }\n\npublic class GameState : IPausable { ... }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702025718-g5rs4nx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-g5rs4nx","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"三、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接口抽象的递进策略"}]},{"ID":"20250702025718-6eov69k","Type":"NodeParagraph","Properties":{"id":"20250702025718-6eov69k","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"当接口变得臃肿时，可采用 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"*"}]},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"*"}]},{"Type":"NodeText","Data":" 接口隔离原则（ISP）"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"*"}]},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"*"}]},{"Type":"NodeText","Data":" 进一步拆分："}]},{"ID":"20250702025718-cx0j1f0","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250702025718-cx0j1f0","updated":"20250702025718"},"Children":[{"ID":"20250702025718-viqvmq9","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250702025718-viqvmq9","updated":"20250702025718"},"Children":[{"ID":"20250702025718-44h13re","Type":"NodeParagraph","Properties":{"id":"20250702025718-44h13re","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"初始接口"},{"Type":"NodeText","Data":"：\ncsharp"}]},{"ID":"20250702025718-tyaicfr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-tyaicfr","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IUserService {\n    void Register();\n    void Login();\n    void Logout();\n    void UpdateProfile();\n    void DeleteAccount();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250702025718-cfsefvo","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250702025718-cfsefvo","updated":"20250702025718"},"Children":[{"ID":"20250702025718-5vbxw4i","Type":"NodeParagraph","Properties":{"id":"20250702025718-5vbxw4i","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"拆分为多个专用接口"},{"Type":"NodeText","Data":"：\ncsharp"}]},{"ID":"20250702025718-9u7gjjo","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-9u7gjjo","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IAuthService {\n    void Login();\n    void Logout();\n}\n\npublic interface IUserManagement {\n    void Register();\n    void UpdateProfile();\n    void DeleteAccount();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250702025718-lrjxgtb","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250702025718-lrjxgtb","updated":"20250702025718"},"Children":[{"ID":"20250702025718-zolchby","Type":"NodeParagraph","Properties":{"id":"20250702025718-zolchby","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"按需实现接口"},{"Type":"NodeText","Data":"：\ncsharp"}]},{"ID":"20250702025718-gfpokyi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-gfpokyi","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public class UserServiceImpl : IAuthService, IUserManagement { ... }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702025718-obs3dww","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-obs3dww","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"四、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"设计决策的流程图"}]},{"ID":"20250702025718-x5yce56","Type":"NodeParagraph","Properties":{"id":"20250702025718-x5yce56","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"plaintext"}]},{"ID":"20250702025718-t5rfn92","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702025718-t5rfn92","updated":"20250702025718"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cGxhaW50ZXh0"},{"Type":"NodeCodeBlockCode","Data":"是否需要定义行为规范？\n│\n├─ 否 → 无需接口\n│\n├─ 是 → 是否需要多继承？\n│     │\n│     ├─ 是 → 使用接口\n│     │\n│     └─ 否 → 是否需要统一管理不同实现？\n│           │\n│           ├─ 是 → 使用接口\n│           │\n│           └─ 否 → 基类是否会变得臃肿？\n│                 │\n│                 ├─ 是 → 使用接口\n│                 │\n│                 └─ 否 → 仅使用基类\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250702025718-cv5cbqw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-cv5cbqw","updated":"20250702030001"},"Children":[{"Type":"NodeText","Data":"五、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"典型案例对比"}]},{"ID":"20250702025718-lki1z1s","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"||","id":"20250702025718-lki1z1s","updated":"20250702030001"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"案例"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"设计选择"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"原因"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"游戏角色系统"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"基类 + 接口"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"基类定义通用属性（如生命值），接口定义特定行为（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFlyable"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ISwimable"},{"Type":"NodeText","Data":"​）。定义行为"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"日志记录器"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"接口（无基类）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"多种实现（控制台日志、文件日志、数据库日志）需统一接口，无公共逻辑可复用。统一管理"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"容器类（如 List\\"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"接口（IEnumerable"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":"T"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":"）+ 基类"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"接口定义遍历行为，基类提供默认实现（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Collection\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​）。定义行为"}]}]}]},{"ID":"20250702025718-objowsg","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702025718-objowsg","updated":"20250702030139"},"Children":[{"Type":"NodeText","Data":"总结：接口是 “基类之上的弹性扩展层”"}]},{"ID":"20250702025718-thkwj2h","Type":"NodeList","ListData":{},"Properties":{"id":"20250702025718-thkwj2h","updated":"20250702025718"},"Children":[{"ID":"20250702025718-eiupbcc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-eiupbcc","updated":"20250702025718"},"Children":[{"ID":"20250702025718-3d0kig0","Type":"NodeParagraph","Properties":{"id":"20250702025718-3d0kig0","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"基类"},{"Type":"NodeText","Data":"：解决 “代码复用” 和 “基本行为约束”。"}]}]},{"ID":"20250702025718-7mnxl9l","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-7mnxl9l","updated":"20250702025718"},"Children":[{"ID":"20250702025718-hwglp0a","Type":"NodeParagraph","Properties":{"id":"20250702025718-hwglp0a","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"接口"},{"Type":"NodeText","Data":"：解决 “多继承需求”“统一管理” 和 “未来扩展”。"}]}]},{"ID":"20250702025718-xz2ji7s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702025718-xz2ji7s","updated":"20250702025718"},"Children":[{"ID":"20250702025718-jnxozhg","Type":"NodeParagraph","Properties":{"id":"20250702025718-jnxozhg","updated":"20250702025718"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"递进关系"},{"Type":"NodeText","Data":"：当基类无法满足上述需求时，抽象出接口层；若接口变得复杂，进一步拆分为多个专用接口。"}]}]}]},{"ID":"20250702025718-0jhr6ju","Type":"NodeParagraph","Properties":{"id":"20250702025718-0jhr6ju","updated":"20250702025718"},"Children":[{"Type":"NodeText","Data":"这种分层抽象既保证了系统的稳定性（基类），又提供了灵活性（接口），是面向对象设计中处理变化与复用的核心手段。"}]},{"ID":"20250702030011-g9in51j","Type":"NodeParagraph","Properties":{"id":"20250702030011-g9in51j","updated":"20250702030011"}},{"ID":"20250702030046-0do9vj4","Type":"NodeParagraph","Properties":{"id":"20250702030046-0do9vj4","updated":"20250702030046"}},{"ID":"20250702030136-n8myv1i","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250702030136-n8myv1i","updated":"20250702040745"},"Children":[{"Type":"NodeText","Data":"贰"}]},{"ID":"20250702030047-olfb8q6","Type":"NodeParagraph","Properties":{"id":"20250702030047-olfb8q6","updated":"20250702033207"},"Children":[{"Type":"NodeText","Data":"GameFramework中的IFsm是基于需要泛型约束，类型安全和统一管理的需求才抽象出来的，而又因为FsmBase无法实现IFsm（因为要实现就必须定义T）所以才不实现IFsm。"}]},{"ID":"20250702040200-nyz5q6c","Type":"NodeParagraph","Properties":{"id":"20250702040200-nyz5q6c","updated":"20250702040630"},"Children":[{"Type":"NodeText","Data":"若没有统一管理的需求，可以将FsmBase改为FsmBase\u003cT\u003e，并将接口中的内容转移到基类中，删除IFsm\u003cT\u003e，单独的泛型约束和类型安全使用基类也能实现。（但是有统一管理的需求就不能是泛型的，因为运行时具体的FsmBase\u003cA\u003e,FsmBase\u003cB\u003e属于不同的类型，因此FsmBase只能是非泛型的，将泛型的东西抽象到接口中）"}]},{"ID":"20250702030300-gzd2k06","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030300-gzd2k06","updated":"20250702040745"},"Children":[{"Type":"NodeText","Data":"一、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt; 接口的核心抽象动机"}]},{"ID":"20250702030300-3k0bmoz","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030300-3k0bmoz","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"泛型约束与类型安全"}]},{"ID":"20250702030300-6kafpvh","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030300-6kafpvh","updated":"20250702030300"},"Children":[{"ID":"20250702030300-6i9ftwi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030300-6i9ftwi","updated":"20250702030300"},"Children":[{"ID":"20250702030300-n4caj8b","Type":"NodeParagraph","Properties":{"id":"20250702030300-n4caj8b","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​通过泛型参数"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​强制约束状态机所有者的类型，确保状态操作的类型安全：\ncsharp"}]},{"ID":"20250702030300-sbpkwfb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030300-sbpkwfb","updated":"20250702030300"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 编译时确保PlayerFsm只能操作与Player相关的状态\nIFsm\u003cPlayer\u003e playerFsm = new Fsm\u003cPlayer\u003e(player);\nplayerFsm.ChangeState\u003cPlayerIdleState\u003e(); // 自动校验PlayerIdleState是否继承自FsmState\u003cPlayer\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702030300-j6pv6xf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030300-j6pv6xf","updated":"20250702040904"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"统一管理不同类型的状态机"}]},{"ID":"20250702030300-o7sg4f4","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030300-o7sg4f4","updated":"20250702040904"},"Children":[{"ID":"20250702030300-imga3h8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030300-imga3h8","updated":"20250702040904"},"Children":[{"ID":"20250702030300-vtuo2ss","Type":"NodeParagraph","Properties":{"id":"20250702030300-vtuo2ss","updated":"20250702040830"},"Children":[{"Type":"NodeText","Data":"尽管状态机的泛型参数"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​不同（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;Player\u0026gt;"},{"Type":"NodeText","Data":"​和"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;Enemy\u0026gt;"},{"Type":"NodeText","Data":"​），但它们都继承了"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​，可通过基类统一管理：\ncsharp"}]},{"ID":"20250702030300-ataeihf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030300-ataeihf","updated":"20250702040904"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 统一存储和操作所有状态机\nList\u003cFsmBase\u003e allFsms = new List\u003cFsmBase\u003e();\nallFsms.Add(playerFsm); // IFsm\u003cPlayer\u003e\nallFsms.Add(enemyFsm);  // IFsm\u003cEnemy\u003e\n\nforeach (var fsm in allFsms) {\n    fsm.Update(); // 调用非泛型方法\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702030300-5qyt1fp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030300-5qyt1fp","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"二、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"FsmBase 不实现 IFsm 的根本原因"}]},{"ID":"20250702030300-j4khuuv","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030300-j4khuuv","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"泛型参数缺失导致无法实现接口"}]},{"ID":"20250702030300-o6oh1o5","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030300-o6oh1o5","updated":"20250702030300"},"Children":[{"ID":"20250702030300-59mkrgx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030300-59mkrgx","updated":"20250702030300"},"Children":[{"ID":"20250702030300-79500vd","Type":"NodeParagraph","Properties":{"id":"20250702030300-79500vd","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​作为非泛型基类，无法定义泛型参数"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"T"},{"Type":"NodeText","Data":"​，因此无法实现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​中的泛型方法（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChangeState\u0026lt;TState\u0026gt;()"},{"Type":"NodeText","Data":"​）：\ncsharp"}]},{"ID":"20250702030300-soaneom","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030300-soaneom","updated":"20250702030300"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 错误示例：FsmBase无法实现IFsm\u003cT\u003e，因为T未定义\npublic abstract class FsmBase : IFsm\u003cT\u003e { // 编译错误：T未定义\n    public abstract T Owner { get; } // 无法确定T的类型\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702030300-acy4yqk","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030300-acy4yqk","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"设计权衡：通过组合而非继承实现协作"}]},{"ID":"20250702030300-u7hwack","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030300-u7hwack","updated":"20250702030300"},"Children":[{"ID":"20250702030300-sa5zkew","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030300-sa5zkew","updated":"20250702030300"},"Children":[{"ID":"20250702030300-2alq94x","Type":"NodeParagraph","Properties":{"id":"20250702030300-2alq94x","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​定义非泛型的公共逻辑（如状态生命周期管理），而"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Fsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​继承"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​并实现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​，通过组合解决泛型与非泛型的隔离：\ncsharp"}]},{"ID":"20250702030300-lgojw07","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030300-lgojw07","updated":"20250702030300"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// Fsm\u003cT\u003e的实际实现方式\npublic class Fsm\u003cT\u003e : FsmBase, IFsm\u003cT\u003e {\n    public T Owner { get; }\n    public void ChangeState\u003cTState\u003e() { /* 实现 */ }\n    // 调用FsmBase的非泛型方法完成具体逻辑\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702030300-s55p3rp","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030300-s55p3rp","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"三、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"这种设计的优势"}]},{"ID":"20250702030300-cr8j9hf","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"|","id":"20250702030300-cr8j9hf","updated":"20250702030300"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"优势"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型安全与灵活性并存"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"通过"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​确保状态操作的类型安全，同时通过"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​支持非泛型统一管理。"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代码复用最大化"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"非泛型逻辑（如状态切换流程）集中在"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​，避免在每个"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Fsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​中重复实现。"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"架构扩展性"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"未来可独立扩展泛型接口（如新增"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsmEvent\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​）或非泛型基类（如"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​添加新方法）。"}]}]}]},{"ID":"20250702030300-m7sinmw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030300-m7sinmw","updated":"20250702041033"},"Children":[{"Type":"NodeText","Data":"四、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"总结：设计决策的本质"}]},{"ID":"20250702030300-c55emvb","Type":"NodeParagraph","Properties":{"id":"20250702030300-c55emvb","updated":"20250702030300"},"Children":[{"Type":"NodeText","Data":"这种设计是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"泛型约束与非泛型统一管理之间的平衡"},{"Type":"NodeText","Data":"："}]},{"ID":"20250702030300-4rnldte","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250702030300-4rnldte","updated":"20250702041033"},"Children":[{"ID":"20250702030300-06zc6wz","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250702030300-06zc6wz","updated":"20250702041028"},"Children":[{"ID":"20250702030300-u5avpfl","Type":"NodeParagraph","Properties":{"id":"20250702030300-u5avpfl","updated":"20250702041028"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"：提供强类型约束，确保状态机操作的安全性。"}]}]},{"ID":"20250702030300-01ahhgh","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250702030300-01ahhgh","updated":"20250702030300"},"Children":[{"ID":"20250702030300-1n3d6qh","Type":"NodeParagraph","Properties":{"id":"20250702030300-1n3d6qh","updated":"20250702030300"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"：剥离非泛型公共逻辑，支持统一管理不同类型的状态机。"}]}]},{"ID":"20250702030300-zjzen6k","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250702030300-zjzen6k","updated":"20250702041033"},"Children":[{"ID":"20250702030300-ohwiiad","Type":"NodeParagraph","Properties":{"id":"20250702030300-ohwiiad","updated":"20250702041033"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Fsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"：作为桥梁，继承"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​并实现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​，将两者能力结合。"}]}]}]},{"ID":"20250702030350-hoqfosr","Type":"NodeParagraph","Properties":{"id":"20250702030350-hoqfosr","updated":"20250702030350"}},{"ID":"20250702030352-26wuaul","Type":"NodeParagraph","Properties":{"id":"20250702030352-26wuaul","updated":"20250702030352"}},{"ID":"20250702030352-c9xd5cn","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250702030352-c9xd5cn","updated":"20250702030715"},"Children":[{"Type":"NodeText","Data":"叁（存疑）"}]},{"ID":"20250702030518-267asmn","Type":"NodeParagraph","Properties":{"id":"20250702030518-267asmn","updated":"20250702030656"},"Children":[{"Type":"NodeText","Data":"通过"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"互换基类和接口的职责"},{"Type":"NodeText","Data":"，IFsm\u003cT\u003e改为IFsm，FsmBase改为FsmBase\u003cT\u003e，同时将原接口和原基类中的内容互换，由基类实现IFsm。"}]},{"ID":"20250702030518-ve6cdg8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-ve6cdg8","updated":"20250702030715"},"Children":[{"Type":"NodeText","Data":"一、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"重构方案的技术实现"}]},{"ID":"20250702030518-an0v5su","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-an0v5su","updated":"20250702030715"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"定义非泛型接口"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250702030518-xcg9kvp","Type":"NodeParagraph","Properties":{"id":"20250702030518-xcg9kvp","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"将原接口中的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"非泛型公共行为"},{"Type":"NodeText","Data":"移至 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250702030518-qq0o3xg","Type":"NodeParagraph","Properties":{"id":"20250702030518-qq0o3xg","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250702030518-ey37ues","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030518-ey37ues","updated":"20250702030715"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public interface IFsm\n{\n    void Start(Type stateType);    // 非泛型状态启动\n    void Shutdown();               // 关闭状态机\n    bool IsRunning { get; }        // 运行状态\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250702030518-918ii15","Type":"NodeParagraph","Properties":{"id":"20250702030518-918ii15","updated":"20250702030524"}},{"ID":"20250702030518-s0vreeh","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-s0vreeh","updated":"20250702042143"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"定义泛型基类 FsmBase\u0026lt;T\u0026gt;"}]},{"ID":"20250702030518-mo5zsg1","Type":"NodeParagraph","Properties":{"id":"20250702030518-mo5zsg1","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"将原接口中的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"泛型约束行为"},{"Type":"NodeText","Data":"和原基类的实现细节移至 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250702030518-aorv9am","Type":"NodeParagraph","Properties":{"id":"20250702030518-aorv9am","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250702030518-qw320lc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030518-qw320lc","updated":"20250702030518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public abstract class FsmBase\u003cT\u003e : IFsm\n{\n    protected readonly T m_Owner;  // 泛型所有者，类型安全\n    \n    public FsmBase(T owner)\n    {\n        m_Owner = owner;\n    }\n    \n    // 显式实现接口的非泛型属性\n    object IFsm.Owner =\u003e m_Owner;\n    \n    // 实现接口的非泛型方法\n    public abstract void Start(Type stateType);\n    public abstract void Shutdown();\n    public abstract bool IsRunning { get; }\n    \n    // 新增：泛型约束的状态切换方法（原接口中的泛型方法）\n    public abstract void ChangeState\u003cTState\u003e() where TState : FsmState\u003cT\u003e;\n    \n    // 原基类中的其他实现细节...\n    protected virtual void OnStateChanged(Type previousStateType, Type currentStateType) { }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250702030518-t9mpj9c","Type":"NodeParagraph","Properties":{"id":"20250702030518-t9mpj9c","updated":"20250702030731"}},{"ID":"20250702030518-5v0tsf0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-5v0tsf0","updated":"20250702042159"},"Children":[{"Type":"NodeText","Data":"3. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"具体实现类 Fsm\u0026lt;T\u0026gt;"}]},{"ID":"20250702030518-nhrknlp","Type":"NodeParagraph","Properties":{"id":"20250702030518-nhrknlp","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250702030518-7i5mzzq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030518-7i5mzzq","updated":"20250702030518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"public class Fsm\u003cT\u003e : FsmBase\u003cT\u003e\n{\n    private bool m_IsRunning;\n    \n    public Fsm(T owner) : base(owner) { }\n    \n    // 实现接口和基类的方法\n    public override void Start(Type stateType) { /* 实现 */ }\n    public override void Shutdown() { /* 实现 */ }\n    public override bool IsRunning =\u003e m_IsRunning;\n    \n    public override void ChangeState\u003cTState\u003e() { /* 实现 */ }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250702030518-wnm0455","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-wnm0455","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"4. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"统一管理与类型安全的结合"}]},{"ID":"20250702030518-govk4mr","Type":"NodeParagraph","Properties":{"id":"20250702030518-govk4mr","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250702030518-x4ne6cd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030518-x4ne6cd","updated":"20250702030518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 1. 统一管理（通过非泛型接口）\nList\u003cIFsm\u003e allFsms = new List\u003cIFsm\u003e();\nallFsms.Add(new Fsm\u003cPlayer\u003e(player));\nallFsms.Add(new Fsm\u003cEnemy\u003e(enemy));\n\nforeach (var fsm in allFsms)\n{\n    fsm.Start(typeof(IdleState));  // 非泛型调用\n}\n\n// 2. 类型安全操作（通过泛型基类）\nif (allFsms[0] is FsmBase\u003cPlayer\u003e playerFsm)\n{\n    playerFsm.ChangeState\u003cPlayerIdleState\u003e();  // 类型安全\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250702030518-4u0xl3l","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-4u0xl3l","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"二、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"这种设计的核心优势"}]},{"ID":"20250702030518-o3w8if8","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250702030518-o3w8if8","updated":"20250702030518"},"Children":[{"ID":"20250702030518-z37y9hg","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250702030518-z37y9hg","updated":"20250702030518"},"Children":[{"ID":"20250702030518-06zr5lm","Type":"NodeParagraph","Properties":{"id":"20250702030518-06zr5lm","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"职责分离更彻底"}]},{"ID":"20250702030518-ct3rtp2","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-ct3rtp2","updated":"20250702030518"},"Children":[{"ID":"20250702030518-n2vn7w8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-n2vn7w8","updated":"20250702030518"},"Children":[{"ID":"20250702030518-hril33q","Type":"NodeParagraph","Properties":{"id":"20250702030518-hril33q","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​：专注于"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"非泛型的统一管理接口"},{"Type":"NodeText","Data":"（如启动、关闭）。"}]}]},{"ID":"20250702030518-25w03h1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-25w03h1","updated":"20250702030518"},"Children":[{"ID":"20250702030518-00hfhja","Type":"NodeParagraph","Properties":{"id":"20250702030518-00hfhja","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​：专注于"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"泛型约束的类型安全实现"},{"Type":"NodeText","Data":"（如状态切换）。"}]}]}]}]},{"ID":"20250702030518-fzouwzv","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250702030518-fzouwzv","updated":"20250702030518"},"Children":[{"ID":"20250702030518-em62ozh","Type":"NodeParagraph","Properties":{"id":"20250702030518-em62ozh","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型安全与统一管理的完美平衡"}]},{"ID":"20250702030518-t9nlv5i","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-t9nlv5i","updated":"20250702030518"},"Children":[{"ID":"20250702030518-tms30ff","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-tms30ff","updated":"20250702030518"},"Children":[{"ID":"20250702030518-kk980za","Type":"NodeParagraph","Properties":{"id":"20250702030518-kk980za","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​ 接口实现不同类型状态机的统一存储和操作。"}]}]},{"ID":"20250702030518-1zb3os2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-1zb3os2","updated":"20250702030518"},"Children":[{"ID":"20250702030518-ogyqix7","Type":"NodeParagraph","Properties":{"id":"20250702030518-ogyqix7","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​ 确保状态机内部操作的类型安全，避免强制类型转换。"}]}]}]}]},{"ID":"20250702030518-6fslzql","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250702030518-6fslzql","updated":"20250702030518"},"Children":[{"ID":"20250702030518-qmevduj","Type":"NodeParagraph","Properties":{"id":"20250702030518-qmevduj","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"架构扩展性增强"}]},{"ID":"20250702030518-lptm8q3","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-lptm8q3","updated":"20250702030518"},"Children":[{"ID":"20250702030518-mpgnz7f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-mpgnz7f","updated":"20250702030518"},"Children":[{"ID":"20250702030518-rgoi8p0","Type":"NodeParagraph","Properties":{"id":"20250702030518-rgoi8p0","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"未来可独立扩展非泛型接口（如新增 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsmDebug"},{"Type":"NodeText","Data":"​ 接口）或泛型基类（如添加 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​ 的新方法）。"}]}]}]}]},{"ID":"20250702030518-z1sjeof","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250702030518-z1sjeof","updated":"20250702030518"},"Children":[{"ID":"20250702030518-9mg13ab","Type":"NodeParagraph","Properties":{"id":"20250702030518-9mg13ab","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代码复用最大化"}]},{"ID":"20250702030518-v2rce20","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-v2rce20","updated":"20250702030518"},"Children":[{"ID":"20250702030518-rc6azzd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-rc6azzd","updated":"20250702030518"},"Children":[{"ID":"20250702030518-ojqz5sz","Type":"NodeParagraph","Properties":{"id":"20250702030518-ojqz5sz","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"将公共逻辑（如状态变更事件）集中在基类，避免重复实现。"}]}]}]}]}]},{"ID":"20250702030518-q0z753t","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-q0z753t","updated":"20250702031144"},"Children":[{"Type":"NodeText","Data":"三、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"与原设计的对比"}]},{"ID":"20250702030518-xh0in7a","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"|width: 487px;|width: 762px;","id":"20250702030518-xh0in7a","updated":"20250702031144"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"维度"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"原设计（IFsm\u0026lt;T\u0026gt; + FsmBase)"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"新设计（IFsm + FsmBase\u0026lt;T\u0026gt;)"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"抽象层级"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"3 层（接口→基类→实现）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"2 层（接口→基类→实现），但职责更清晰"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型安全"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"✅（全程无需类型转换）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"✅（泛型操作安全，非泛型需少量转换）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"统一管理"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"⚠️（需通过基类 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase"},{"Type":"NodeText","Data":"​）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"✅（直接通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​，更自然）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代码复用"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"⚠️（泛型与非泛型逻辑分离）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"✅（统一在基类）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"扩展性"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"中等（需修改接口或基类）"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"高（接口与基类可独立扩展）"}]}]}]},{"ID":"20250702030518-zb6wag5","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-zb6wag5","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"四、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"潜在问题与解决方案"}]},{"ID":"20250702030518-k3tws7g","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-k3tws7g","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型转换的少量使用"}]},{"ID":"20250702030518-k4gmcez","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-k4gmcez","updated":"20250702030518"},"Children":[{"ID":"20250702030518-ki6i1xd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-ki6i1xd","updated":"20250702030518"},"Children":[{"ID":"20250702030518-t9lqqw6","Type":"NodeParagraph","Properties":{"id":"20250702030518-t9lqqw6","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm"},{"Type":"NodeText","Data":"​ 访问泛型方法时需转换为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​：\ncsharp"}]},{"ID":"20250702030518-5brgmys","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250702030518-5brgmys","updated":"20250702030518"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 解决方案1：使用模式匹配（安全）\nif (fsm is FsmBase\u003cPlayer\u003e playerFsm)\n{\n    playerFsm.ChangeState\u003cPlayerIdleState\u003e();\n}\n\n// 解决方案2：扩展方法封装转换\npublic static void SafeChangeState\u003cT, TState\u003e(this IFsm fsm)\n    where TState : FsmState\u003cT\u003e\n{\n    if (fsm is FsmBase\u003cT\u003e typedFsm)\n        typedFsm.ChangeState\u003cTState\u003e();\n}\n\n// 使用时\nfsm.SafeChangeState\u003cPlayer, PlayerIdleState\u003e();\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250702030518-joi35nf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250702030518-joi35nf","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"与现有代码的兼容性"}]},{"ID":"20250702030518-ofsjz96","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-ofsjz96","updated":"20250702030518"},"Children":[{"ID":"20250702030518-dxpswav","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-dxpswav","updated":"20250702030518"},"Children":[{"ID":"20250702030518-gbfs3az","Type":"NodeParagraph","Properties":{"id":"20250702030518-gbfs3az","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"若框架中已有代码依赖 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"IFsm\u0026lt;T\u0026gt;"},{"Type":"NodeText","Data":"​，需进行重构。但新设计更符合直觉，重构后代码更简洁。"}]}]}]},{"ID":"20250702030518-xqykx14","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-xqykx14","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"五、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"适用场景"}]},{"ID":"20250702030518-kbgt716","Type":"NodeParagraph","Properties":{"id":"20250702030518-kbgt716","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"这种设计尤其适合以下场景："}]},{"ID":"20250702030518-ilsq2xg","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250702030518-ilsq2xg","updated":"20250702030518"},"Children":[{"ID":"20250702030518-xkvmpaj","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250702030518-xkvmpaj","updated":"20250702030518"},"Children":[{"ID":"20250702030518-o616sky","Type":"NodeParagraph","Properties":{"id":"20250702030518-o616sky","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"需要频繁统一管理状态机"},{"Type":"NodeText","Data":"：例如游戏中的状态机管理器需要批量操作不同类型的状态机。"}]}]},{"ID":"20250702030518-kr3p1cm","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250702030518-kr3p1cm","updated":"20250702030518"},"Children":[{"ID":"20250702030518-hbgu0ru","Type":"NodeParagraph","Properties":{"id":"20250702030518-hbgu0ru","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型安全要求高"},{"Type":"NodeText","Data":"：状态机内部操作涉及复杂的泛型约束，需避免类型转换。"}]}]},{"ID":"20250702030518-x83p6fs","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250702030518-x83p6fs","updated":"20250702030518"},"Children":[{"ID":"20250702030518-fmfx1fd","Type":"NodeParagraph","Properties":{"id":"20250702030518-fmfx1fd","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"追求架构清晰度"},{"Type":"NodeText","Data":"：希望通过接口和基类的职责分离，使代码结构更直观。"}]}]}]},{"ID":"20250702030518-8g30pkd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250702030518-8g30pkd","updated":"20250702031404"},"Children":[{"Type":"NodeText","Data":"总结：设计选择的最佳实践"}]},{"ID":"20250702030518-ask6c3g","Type":"NodeParagraph","Properties":{"id":"20250702030518-ask6c3g","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"你的方案通过"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"互换接口和基类的职责"},{"Type":"NodeText","Data":"，实现了更优雅的抽象分层："}]},{"ID":"20250702030518-dheu8m0","Type":"NodeList","ListData":{},"Properties":{"id":"20250702030518-dheu8m0","updated":"20250702031404"},"Children":[{"ID":"20250702030518-qwwb0py","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-qwwb0py","updated":"20250702030518"},"Children":[{"ID":"20250702030518-dcfjpwl","Type":"NodeParagraph","Properties":{"id":"20250702030518-dcfjpwl","updated":"20250702030518"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"IFsm 接口"},{"Type":"NodeText","Data":"：作为非泛型的统一管理入口，聚焦于状态机的生命周期控制。"}]}]},{"ID":"20250702030518-3vano4x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250702030518-3vano4x","updated":"20250702031404"},"Children":[{"ID":"20250702030518-jps3sd8","Type":"NodeParagraph","Properties":{"id":"20250702030518-jps3sd8","updated":"20250702031404"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"FsmBase\u0026lt;T\u0026gt;基类"},{"Type":"NodeText","Data":"：作为泛型实现的核心，确保所有状态操作的类型安全。"}]}]}]},{"ID":"20250702030518-zvpnrl6","Type":"NodeParagraph","Properties":{"id":"20250702030518-zvpnrl6","updated":"20250702030518"},"Children":[{"Type":"NodeText","Data":"这种设计在"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"类型安全"},{"Type":"NodeText","Data":"、"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"统一管理"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"架构清晰度"},{"Type":"NodeText","Data":"之间取得了最佳平衡，是大型游戏框架中状态机模块的理想实现方式。"}]}]}