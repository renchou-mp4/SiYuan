{"ID":"20250618180500-wmga5up","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250618180500-wmga5up","title":"C# Flags特性","type":"doc","updated":"20250618180810"},"Children":[{"ID":"20250618180512-ooge3a7","Type":"NodeParagraph","Properties":{"id":"20250618180512-ooge3a7","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"在 C# 中，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags]"},{"Type":"NodeText","Data":"​ 特性（也称为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"FlagsAttribute"},{"Type":"NodeText","Data":"​）用于"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"枚举类型"},{"Type":"NodeText","Data":"，其作用是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"允许将枚举值作为位域（Bit Field）组合使用"},{"Type":"NodeText","Data":"。以下是详细解析："}]},{"ID":"20250618180512-ebk0k0p","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-ebk0k0p","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1. 基础概念"}]},{"ID":"20250618180512-4uehvlc","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-4uehvlc","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"普通枚举"}]},{"ID":"20250618180512-68pc19w","Type":"NodeParagraph","Properties":{"id":"20250618180512-68pc19w","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"普通枚举的每个值是独立的，只能赋值其中一个："}]},{"ID":"20250618180512-qbwgjfl","Type":"NodeParagraph","Properties":{"id":"20250618180512-qbwgjfl","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-tvx5rqk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-tvx5rqk","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"enum Color\n{\n    Red,    // 0\n    Green,  // 1\n    Blue    // 2\n}\n\nColor c = Color.Red; // 只能选一个值\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-8yzftlb","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-8yzftlb","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"带"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong code","TextMarkTextContent":"[Flags]"},{"Type":"NodeText","Data":"​ "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"的枚举"}]},{"ID":"20250618180512-cpmal15","Type":"NodeParagraph","Properties":{"id":"20250618180512-cpmal15","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"允许将多个枚举值组合为一个值（通过按位或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"|"},{"Type":"NodeText","Data":"​ 操作）："}]},{"ID":"20250618180512-ylb2m9p","Type":"NodeParagraph","Properties":{"id":"20250618180512-ylb2m9p","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-f5pgkj5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-f5pgkj5","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"[Flags]\nenum Permissions\n{\n    None = 0,        // 0000\n    Read = 1,        // 0001\n    Write = 2,       // 0010\n    Delete = 4,      // 0100\n    All = Read | Write | Delete  // 0111\n}\n\nPermissions p = Permissions.Read | Permissions.Write; // 组合多个值\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-042fzvm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-042fzvm","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"2. 关键规则"}]},{"ID":"20250618180512-co40eta","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250618180512-co40eta","updated":"20250618180512"},"Children":[{"ID":"20250618180512-99pkqg9","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250618180512-99pkqg9","updated":"20250618180512"},"Children":[{"ID":"20250618180512-ah7k3hn","Type":"NodeParagraph","Properties":{"id":"20250618180512-ah7k3hn","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"枚举值应为 2 的幂"},{"Type":"NodeText","Data":"：每个值对应二进制的一位（如 1, 2, 4, 8...）。"}]}]},{"ID":"20250618180512-4adgqnp","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250618180512-4adgqnp","updated":"20250618180512"},"Children":[{"ID":"20250618180512-8jtzlo7","Type":"NodeParagraph","Properties":{"id":"20250618180512-8jtzlo7","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"推荐定义"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong code","TextMarkTextContent":"None = 0"},{"Type":"NodeText","Data":"​：表示不包含任何标志。"}]}]},{"ID":"20250618180512-jfsvaa4","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250618180512-jfsvaa4","updated":"20250618180512"},"Children":[{"ID":"20250618180512-67qxy20","Type":"NodeParagraph","Properties":{"id":"20250618180512-67qxy20","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"可定义组合值"},{"Type":"NodeText","Data":"：如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"All = Read | Write | Delete"},{"Type":"NodeText","Data":"​。"}]}]}]},{"ID":"20250618180512-y33y7n4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-y33y7n4","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"3. 常用操作"}]},{"ID":"20250618180512-y0x33kl","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-y0x33kl","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"(1) 组合多个值"}]},{"ID":"20250618180512-gvkbnsh","Type":"NodeParagraph","Properties":{"id":"20250618180512-gvkbnsh","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-93c7cpv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-93c7cpv","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"Permissions p = Permissions.Read | Permissions.Write; // 0011\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-fru2hgp","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-fru2hgp","updated":"20250618180810"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"(2) 检查是否包含某个值"}]},{"ID":"20250618180512-96h78r1","Type":"NodeParagraph","Properties":{"id":"20250618180512-96h78r1","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-4yocftf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-4yocftf","updated":"20250618180810"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"bool hasRead = p.HasFlag(Permissions.Read); // true\nbool hasDelete = p.HasFlag(Permissions.Delete); // false\nbool hasRead = p \u0026 Permissions.Read == Permissions.Read // true \u0026运算，只有当对应的位都是1，结果才是1\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-er81v8v","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-er81v8v","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"(3) 移除某个值"}]},{"ID":"20250618180512-2qog4dd","Type":"NodeParagraph","Properties":{"id":"20250618180512-2qog4dd","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-hjhpzz5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-hjhpzz5","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"p = p \u0026 ~Permissions.Write; // 移除Write权限，结果为Permissions.Read (0001)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-13zcfi1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250618180512-13zcfi1","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"(4) 添加某个值"}]},{"ID":"20250618180512-fzzyrim","Type":"NodeParagraph","Properties":{"id":"20250618180512-fzzyrim","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-k3vy1q6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-k3vy1q6","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"p = p | Permissions.Delete; // 添加Delete权限，结果为0101\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-m9x4ju8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-m9x4ju8","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"4. 与"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong code","TextMarkTextContent":"ToString()"},{"Type":"NodeText","Data":"​ "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"的交互"}]},{"ID":"20250618180512-yvypdrc","Type":"NodeParagraph","Properties":{"id":"20250618180512-yvypdrc","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags]"},{"Type":"NodeText","Data":"​ 会改变枚举的字符串表示："}]},{"ID":"20250618180512-pyw227i","Type":"NodeParagraph","Properties":{"id":"20250618180512-pyw227i","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"csharp"}]},{"ID":"20250618180512-tokuk5u","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-tokuk5u","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"[Flags]\nenum Days\n{\n    None = 0,\n    Monday = 1,\n    Tuesday = 2,\n    Wednesday = 4\n}\n\nDays d = Days.Monday | Days.Wednesday;\nConsole.WriteLine(d); // 输出 \"Monday, Wednesday\"（自动组合名称）\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250618180512-n536ebf","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-n536ebf","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"5. 应用场景"}]},{"ID":"20250618180512-d3qlbvd","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"|","id":"20250618180512-d3qlbvd","updated":"20250618180512"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"场景"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"示例"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"权限系统"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags] enum Permissions { Read, Write, Delete }"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"配置选项"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags] enum Features { Logging, Caching, Compression }"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"位掩码操作"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"如文件系统的读写权限（类似 Linux 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"chmod"},{"Type":"NodeText","Data":"​）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"多状态组合"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"如游戏中的角色状态（"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags] enum Status { Frozen, Burned, Poisoned }"},{"Type":"NodeText","Data":"​）"}]}]}]},{"ID":"20250618180512-i24cpfn","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-i24cpfn","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"6. 注意事项"}]},{"ID":"20250618180512-xura51g","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250618180512-xura51g","updated":"20250618180512"},"Children":[{"ID":"20250618180512-b3i5x3l","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250618180512-b3i5x3l","updated":"20250618180512"},"Children":[{"ID":"20250618180512-m4ujc38","Type":"NodeParagraph","Properties":{"id":"20250618180512-m4ujc38","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"非 2 的幂值可能导致意外行为"},{"Type":"NodeText","Data":"：\ncsharp"}]},{"ID":"20250618180512-ho57l1b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250618180512-ho57l1b","updated":"20250618180512"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"[Flags]\nenum InvalidFlags\n{\n    A = 1,\n    B = 3,  // 非2的幂（二进制为0011）\n    C = 4\n}\n\nInvalidFlags x = InvalidFlags.A | InvalidFlags.B; // 结果为B（0011）\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250618180512-1qmc6vj","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250618180512-1qmc6vj","updated":"20250618180512"},"Children":[{"ID":"20250618180512-acz2bx5","Type":"NodeParagraph","Properties":{"id":"20250618180512-acz2bx5","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"性能考虑"},{"Type":"NodeText","Data":"：位运算比普通枚举稍慢，但在大多数场景下可忽略不计。"}]}]}]},{"ID":"20250618180512-gnqywp8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250618180512-gnqywp8","updated":"20250618180512"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"总结"}]},{"ID":"20250618180512-hz22d89","Type":"NodeParagraph","Properties":{"id":"20250618180512-hz22d89","updated":"20250618180512"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[Flags]"},{"Type":"NodeText","Data":"​ 特性使枚举可以作为"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"位域"},{"Type":"NodeText","Data":"使用，通过位运算高效组合多个值。常见于权限系统、配置选项等需要多状态组合的场景。使用时需确保枚举值为 2 的幂，以避免逻辑错误。"}]}]}