{"ID":"20231211204632-bkarckh","Spec":"1","Type":"NodeDocument","Properties":{"id":"20231211204632-bkarckh","title":"Unity AssetBundle","type":"doc","updated":"20231215165751"},"Children":[{"ID":"20231213155018-ukv9sh1","Type":"NodeParagraph","Properties":{"id":"20231213155018-ukv9sh1","updated":"20231213155018"},"Children":[{"Type":"NodeText","Data":"一、为什么项目开发一般要使用AssetBundle对资源进行打包，加载和卸载？\n为什么项目开发一般要使用AssetBundle对资源进行打包，加载和卸载？\n主要原因有以下几点："}]},{"ID":"20231213155018-t41x5z3","Type":"NodeParagraph","Properties":{"id":"20231213155018-t41x5z3","updated":"20231213155122"},"Children":[{"Type":"NodeText","Data":"游戏资源一般来说只有在被使用到或即将被使用到时才应该被加载进内存中，不应该一直出现在场景里。很容易理解，我刚打开游戏的第一关，我需要将第10关的BOSS提前在内存中加载好吗？这无疑是对内存空间的极大浪费，所以我们要对资源进行合理的加载和卸载，使用时加载，用完后卸载。（按需使用、按需卸载）\nUnity对资源进行加载和卸载主要有两种方式:Resources和AssetBundle。AssetBundle相比于Resources来说，最主要的优势就是对于游戏的资源热更新。比如说，我现在有一个安装包1G大小的手游，现在有一个1M大小的资源A出问题了，我将这个资源A替换成了另一个同样1M大小的资源B，此时差距就出现了：（热更新）\n（1）如果我使用Resources管理资源，资源是全部存储在安装包中的，那么我替换完成后，为了让用户同步到这次的资源更新，我得再重新将整个游戏打一个新的包，也就是说，仅仅是替换了一个1M的资源，用户却必须重新下载1G的新包进行安装。这无论是从效率上还是用户体验上来说都是非常差劲的。\n（2）如果我使用AssetBundle管理资源，资源是和安装包分离，单独打包的。而且一个游戏的资源一般会按照类型或是逻辑分成很多小包，游戏运行时需要用到什么资源就从对应的包中读取相应的资源。如此一来，当我们替换资源A后，只需要将A资源所在的包（bundle）进行更新，重新将这个bundle发布给用户，直接覆盖原先的bundle即可，替换一个1M的资源可能只需要用户下载2-10M即可完成，基本保证了用户无需下载未改动的部分。\n"}]},{"ID":"20231211205632-pgg501o","Type":"NodeParagraph","Properties":{"id":"20231211205632-pgg501o","updated":"20231211205632"}},{"ID":"20231211205632-pxeea63","Type":"NodeParagraph","Properties":{"id":"20231211205632-pxeea63","updated":"20231211205632"}},{"ID":"20231211205633-rrkqote","Type":"NodeParagraph","Properties":{"id":"20231211205633-rrkqote","updated":"20231215165751"},"Children":[{"Type":"NodeText","Data":"Include In Build是用来选择是否在构建的时候包含该图集，例如有一个图集有多个变体集，那么在为不同性能的硬件构建时，会选择这些变体集中的某一个，那么就给选择的变体集勾选Include In Build，不勾选的就不会进入构建中。如果使用了AB包，那么勾选了Include In Build的图集会被打进AB包，没有勾选的则不会。经验证，勾选"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Include In Build"},{"Type":"NodeText","Data":"​后，打AB包构建的APK和不打AB包构建的APK，大小上的差距只有AB包的差距。因此不会有重复的资源"}]},{"ID":"20231211205633-bxpjd6w","Type":"NodeParagraph","Properties":{"id":"20231211205633-bxpjd6w","updated":"20231211205633"}},{"ID":"20231211205633-rxmgmq5","Type":"NodeParagraph","Properties":{"id":"20231211205633-rxmgmq5","updated":"20231213160600"},"Children":[{"Type":"NodeText","Data":"1》将图片打入图集，再将图集打入AB。然后将使用了图片的预制体打成ab，不会产生依赖。且必须使用下面的方法加载图片——》因为场景中的物体并不是引用Atlas，而是Sprite"}]},{"ID":"20231211210352-18uen7n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231211210352-18uen7n","style":"line-height: 22px;","updated":"20231211210734"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"AssetBundle assetBundle = AssetBundle.LoadFromFile(\"Assets/Bundles/AtlasTestAB.ab\");\nSpriteAtlas atlas = assetBundle.LoadAsset\u003cSpriteAtlas\u003e(\"TestAtlas\");\nimg.sprite = atlas.GetSprite(\"bg_pve_hang_up_customs pass_common_01\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231211210408-vdqlsc1","Type":"NodeParagraph","Properties":{"id":"20231211210408-vdqlsc1"}},{"ID":"20231211205827-ayrz6bs","Type":"NodeParagraph","Properties":{"id":"20231211205827-ayrz6bs","updated":"20231211211509"},"Children":[{"Type":"NodeText","Data":"2》将图片打入图集，再将图片打入AB。将使用了图片的预制体打成ab，会产生依赖。且必须使用下面的方法加载图片"}]},{"ID":"20231211210651-6ep65nd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231211210651-6ep65nd","style":"line-height: 22px;","updated":"20231211210705"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"AssetBundle assetBundle = AssetBundle.LoadFromFile(\"Assets/Bundles/AtlasTestAB.ab\");\nimg.sprite = assetBundle.LoadAsset\u003cSprite\u003e(\"bg_pve_hang_up_customs pass_common_01\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231211205710-8phdynr","Type":"NodeParagraph","Properties":{"id":"20231211205710-8phdynr","updated":"20231211205710"}},{"ID":"20231212113103-gqjxut9","Type":"NodeParagraph","Properties":{"id":"20231212113103-gqjxut9","updated":"20231213161514"},"Children":[{"Type":"NodeText","Data":"AB包打包依赖："}]},{"ID":"20231213161514-9ae4kz9","Type":"NodeParagraph","Properties":{"id":"20231213161514-9ae4kz9","updated":"20231213171253"},"Children":[{"Type":"NodeText","Data":"如果AB1和AB2都引用了一个材质t1，那么AB1和AB2会分别创建一个t1的副本，这就造成了资源重复。如果预制体P1引用了材质t1，预制体P2引用了预制体P2，再分别将P1和P2打包进AB1和AB2，那么AB1和AB2都会产生一个t1副本。上面的情况就需要将t1抽出单独打包。"}]},{"ID":"20231212113104-lyjdxo8","Type":"NodeParagraph","Properties":{"id":"20231212113104-lyjdxo8","updated":"20231212113104"}},{"ID":"20231212113104-dhm3gwm","Type":"NodeParagraph","Properties":{"id":"20231212113104-dhm3gwm","updated":"20231212113104"}},{"ID":"20231212113104-litbdd9","Type":"NodeParagraph","Properties":{"id":"20231212113104-litbdd9","updated":"20231212113104"}},{"ID":"20231212113104-ti6nrks","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231212113104-ti6nrks","updated":"20231212113128"},"Children":[{"Type":"NodeText","Data":"参考资料"}]},{"ID":"20231212113145-bvhmjug","Type":"NodeParagraph","Properties":{"id":"20231212113145-bvhmjug","updated":"20231212113146"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://docs.unity.cn/cn/2021.1/Manual/SpriteAtlasWorkflow.html","TextMarkTextContent":"精灵图集工作流程 - Unity 手册"}]},{"ID":"20231213155027-s0lij94","Type":"NodeParagraph","Properties":{"id":"20231213155027-s0lij94","updated":"20231213155028"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://blog.csdn.net/qq_45035709/article/details/113522534","TextMarkTextContent":"Unity使用AssetBundle（AB包）实现资源的打包，加载和卸载_去除容器路径的assetbundle打包-CSDN博客"}]},{"ID":"20231213161505-0i2q7xv","Type":"NodeParagraph","Properties":{"id":"20231213161505-0i2q7xv","updated":"20231213161505"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://zhuanlan.zhihu.com/p/34137188","TextMarkTextContent":"【资源】AssetBundle打包依赖分析 - 知乎 (zhihu.com)"}]},{"ID":"20231214102558-31q8nqy","Type":"NodeParagraph","Properties":{"id":"20231214102558-31q8nqy","updated":"20231214102559"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.jianshu.com/p/1b1527faaca2","TextMarkTextContent":"Unity AssetBundle(1):Assets打包和依赖(Dependencies)理解 - 简书 (jianshu.com)"}]},{"ID":"20231214104437-2etvtgu","Type":"NodeParagraph","Properties":{"id":"20231214104437-2etvtgu","updated":"20231214104438"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.jianshu.com/p/0d18ac565563","TextMarkTextContent":"Unity AssetBundle(3):图集Atlas与AB包 - 简书 (jianshu.com)"}]}]}