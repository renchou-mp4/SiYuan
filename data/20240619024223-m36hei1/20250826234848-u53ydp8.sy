{"ID":"20250826234848-u53ydp8","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250826234848-u53ydp8","title":"Unity 帧同步和状态同步","type":"doc","updated":"20250908145600"},"Children":[{"ID":"20250826235320-n2dti8t","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250826235320-n2dti8t","updated":"20250827001447"},"Children":[{"Type":"NodeText","Data":"问题 1：SLG 游戏（如《率土之滨》《三国志・战略版》）中，常见的网络同步模型有哪两种？请结合 SLG 的核心场景（如大地图探索、实时遭遇战）说明它们的适用场景及选择原因。"}]},{"ID":"20250826235320-03owdjf","Type":"NodeParagraph","Properties":{"id":"20250826235320-03owdjf","updated":"20250826235320"},"Children":[{"Type":"NodeText","Data":"// 答案：SLG 中核心同步模型为"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"帧同步"},{"Type":"NodeText","Data":"和​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"状态同步"},{"Type":"NodeText","Data":"​，二者需根据场景特性选择，核心差异在于 “数据传输内容” 和 “逻辑计算主体”：\n// 1. 帧同步：\n//- 传输内容：仅同步 “玩家输入指令”（如 “军队向 A 点移动”“释放技能 X”），不传输计算结果；\n//- 计算主体：客户端与服务器使用相同的逻辑帧频率（如 15fps），基于相同输入和初始状态，独立计算出完全一致的游戏状态；\n//- 适用 SLG 场景：实时战斗（如小规模遭遇战、武将单挑），原因是 SLG 战斗需强一致性（如伤害数值、技能命中判定不能客户端间有差异），帧同步能保证多端逻辑完全对齐，且输入指令数据量极小（避免实时战斗中高频传输状态的带宽压力）。\n// 2. 状态同步：\n//- 传输内容：同步 “游戏实体的关键状态快照”（如军队位置、血量、资源数量、建筑等级），不传输输入；\n//- 计算主体：服务器独立计算所有逻辑（如军队移动路径、资源产出），客户端仅接收并渲染服务器下发的状态；\n//- 适用 SLG 场景：大地图全局同步（如多玩家军队移动、资源点占领、建筑升级），原因是 SLG 大地图实体数量极多（数千个玩家军队、上万资源点），若用帧同步需所有客户端同步所有实体输入，带宽爆炸；而状态同步仅传输 “变化的关键状态”（如军队从 A 点到 B 点的最终位置，而非每帧移动指令），能大幅降低数据量，且服务器权威计算可避免作弊（如客户端篡改资源数量）。\n// 补充：主流 SLG 多采用 “混合同步”，即 “大地图用状态同步 + 战斗用帧同步”，兼顾全局带宽效率和局部战斗一致性。"}]},{"ID":"20250827001447-ds258fz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827001447-ds258fz","updated":"20250827172130"},"Children":[{"Type":"NodeText","Data":"问题 2：SLG 大地图存在 “海量实体”（如 1000 + 玩家的军队、5000 + 资源点、200 + 城池），若直接对所有实体进行全量实时同步，会导致带宽过载和客户端卡顿。请说明你会通过哪些技术方案解决 “海量实体同步的数据量与及时性平衡” 问题？"}]},{"ID":"20250827001447-odt44wg","Type":"NodeParagraph","Properties":{"id":"20250827001447-odt44wg","updated":"20250827001447"},"Children":[{"Type":"NodeText","Data":"// 答案：核心思路是 “按需同步、数据瘦身、动态调优”，具体方案如下：\n// 1. 分层视野同步（核心）：\n//- 按 “玩家视野范围” 分层：仅同步玩家当前视野内（如屏幕范围内 + 2 格缓冲）的实体，视野外实体不同步或仅同步 “粗略状态”（如仅记录 “某玩家军队在 X 区域”，不传输具体坐标）；\n//- 按 “实体重要性” 分层：优先同步高优先级实体（如玩家自己的军队、敌方进攻军队、联盟城池），低优先级实体（如中立资源点、远处非交战军队）降低同步频率或延迟同步；\n// 2. 数据压缩与协议优化：\n//- 协议选型：用 Protobuf（二进制协议）替代 JSON（文本协议），减少 30%-50% 数据体积；\n//- 字段精简：仅传输 “变化的状态”（如军队位置从 (10,20) 变为 (12,20)，仅传新坐标，不重复传军队 ID、类型等固定信息）；\n//- 数值压缩：用 uint16 存储 “坐标”（如地图范围 0-65535，足够覆盖 SLG 大地图），替代 int32，减少一半字节；\n// 3. 同步频率动态调整：\n//- 近处实体（如视野内 5 格）：高频同步（1-2 次 / 秒），保证操作及时性；\n//- 远处实体（如视野外 10 格）：低频同步（1 次 / 5 秒），降低带宽；\n//- 静态实体（如已占领的资源点）：仅在状态变化时同步（如被敌方抢夺），无变化不传输；\n// 4. 实体池与对象复用：\n//- 客户端用 “对象池” 管理大地图实体（如军队预制体），避免同步新实体时频繁创建 / 销毁 GameObject 导致的卡顿，同时减少实体初始化时的状态同步数据（复用对象仅需更新差异状态）"}]},{"ID":"20250827172130-s72yvt0","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827172130-s72yvt0","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"问题 3：SLG 实时战斗场景中（如 3v3 武将对战），常出现 “客户端延迟 / 丢包” 导致的 “状态不一致”（如 A 客户端显示武将 A 存活，B 客户端显示武将 A 已阵亡）。请说明你会如何设计同步逻辑保证战斗状态一致性，以及如何处理延迟 / 丢包问题？"}]},{"ID":"20250827172130-gzg41p5","Type":"NodeParagraph","Properties":{"id":"20250827172130-gzg41p5","updated":"20250827172130"},"Children":[{"Type":"NodeText","Data":"// 答案：核心原则是 “服务器权威 + 客户端预测与修正”，具体方案：\n// 一、保证状态一致性的基础设计：\n// 1. 服务器帧同步主导：\n//- 战斗逻辑强制走帧同步，服务器统一管理 “帧号”（如每 16ms 一个逻辑帧），所有客户端必须对齐服务器帧号才能进行计算；\n//- 客户端输入指令需先发送到服务器，服务器校验合法性（如 “技能是否在 CD 中”“是否有释放条件”）后，再广播给所有客户端，避免非法输入导致的不一致；\n// 2. 关键状态服务器校验：\n//- 战斗中核心状态（如武将血量、技能 CD、Buff 持续时间）每 N 帧（如 10 帧）由服务器向所有客户端下发 “权威快照”，客户端收到后对比本地状态，若差异超过阈值（如血量差 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" 100），则强制覆盖本地状态，保证最终一致性；\n// 二、延迟 / 丢包的处理方案：\n// 1. 丢包重传与冗余：\n//- 采用 “ARQ 协议（自动重传请求）”：客户端未收到服务器确认的输入指令 / 帧数据时，自动重传（重传次数限制为 3 次，避免无限重传拥堵）；\n//- 关键帧冗余传输：对战斗中的 “转折点帧”（如技能释放帧、武将阵亡帧），服务器额外多发 1-2 次（间隔 1 帧），降低丢包概率；\n// 2. 客户端预测与回滚（缓解延迟体验）：\n//- 输入预测：客户端发送输入指令后，不等待服务器确认，先基于本地逻辑预测执行（如预测武将移动路径、技能伤害），避免 “按了技能后等 0.5 秒才反应” 的卡顿感；\n//- 服务器回滚修正：若服务器下发的权威帧数据与客户端预测结果不一致（如客户端预测技能命中，服务器判定未命中），客户端则 “回滚到上一权威帧”，重新基于服务器数据计算当前帧状态，保证最终对齐（回滚时需隐藏视觉跳变，如用平滑插值过渡）；\n// 3. 帧缓冲与追赶：\n//- 客户端维护 “帧缓冲队列”（如缓存 3 帧服务器数据），若网络延迟突然升高，从缓冲队列中取历史帧计算，避免 “帧中断”；\n//- 若客户端帧号落后服务器超过 5 帧（如延迟过高），则触发 “快速追赶”（跳过非关键帧的渲染，仅计算逻辑帧），快速对齐服务器帧号，避免差距过大。"}]},{"ID":"20250827205657-tdqgmvi","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827205657-tdqgmvi","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"问题 4：SLG 存在大量 “长周期异步操作”（如建筑升级需 2 小时、科技研究需 8 小时、军队征兵需 30 分钟），这类操作玩家可能中途离线。请说明如何设计这类操作的网络同步逻辑，确保 “离线期间操作正常推进” 且 “上线后状态同步准确”？"}]},{"ID":"20250827205657-nqqkiob","Type":"NodeParagraph","Properties":{"id":"20250827205657-nqqkiob","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"// 答案：核心原则是 “服务器计时权威 + 离线状态持久化 + 上线增量同步”，具体方案：\n// 1. 服务器完全掌控计时与逻辑（防作弊 + 保准确）：\n//- 客户端仅负责 “操作发起”（如点击 “升级军营”）和 “状态展示”，不参与任何计时或进度计算；\n//- 服务器收到操作请求后，校验合法性（如资源是否足够、是否有建造队列冲突），校验通过后：\n// a. 记录操作关键信息（操作类型、开始时间、预计完成时间、当前进度）到数据库；\n// b. 向客户端返回 “操作已受理” 的确认消息，客户端开始显示 “虚假进度条”（基于服务器返回的预计完成时间，本地模拟进度，不影响实际逻辑）；\n// 2. 离线期间状态自动推进：\n//- 服务器无需 “实时计算进度”，而是采用 “惰性计算”：玩家离线时，数据库仅存储 “预计完成时间”，不更新中间进度；\n//- 当玩家再次上线时，服务器才计算 “当前时间与预计完成时间的差值”：\n// a. 若当前时间≥预计完成时间：操作直接标记为 “已完成”，计算并发放奖励（如军营等级提升、解锁新功能）；\n// b. 若当前时间 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":" 预计完成时间：计算剩余进度（如 “2 小时升级，已过 1.5 小时，剩余 0.5 小时”），将 “剩余时间” 和 “当前进度” 下发给客户端；\n// 3. 上线时增量同步（减少数据量）：\n//- 服务器为每个玩家维护 “同步版本号”（如玩家操作的全局版本号，每完成一个长周期操作，版本号 + 1）；\n//- 玩家上线时，客户端向服务器发送 “本地最新版本号”，服务器对比后仅下发 “版本号差异对应的操作状态”（如玩家离线期间完成了 “军营升级” 和 “科技研究”，仅同步这两个操作的结果，不传输其他未变化的状态）；\n// 4. 异常处理（如服务器时间偏差、操作中断）：\n//- 服务器采用 “UTC 时间” 而非本地时间，避免服务器集群间时间偏差导致的进度错误；\n//- 若操作过程中服务器重启，数据库中存储的 “开始时间 + 预计完成时间” 不会丢失，重启后仍可基于该数据重新计算进度，保证操作不中断。"}]},{"ID":"20250827205657-qva21f4","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827205657-qva21f4","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"问题 5：在 SLG 联盟攻城场景中，多个玩家（如 10 人）可能同时对 “同一城墙” 发起攻击（如同时派遣攻城车攻击），容易出现 “并发操作冲突”（如服务器同时收到 10 个 “扣除城墙 100 血量” 的请求，导致城墙血量从 1000 直接扣到 0，而非正确扣 1000）。请说明如何解决这类多客户端并发操作的同步冲突问题？"}]},{"ID":"20250827205657-a1qx8kj","Type":"NodeParagraph","Properties":{"id":"20250827205657-a1qx8kj","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"// 答案：核心思路是 “服务器端串行化处理 + 状态锁 + 最终一致性校验”，具体方案：\n// 1. 服务器端操作排队与串行化：\n//- 对 “同一实体（如城墙）” 的所有修改操作（如扣血、修复），服务器维护一个 “操作队列”，按 “请求到达时间戳” 排序，逐个执行，避免并行计算导致的冲突；\n//- 例如：10 个 “扣 100 血” 的请求按顺序执行，城墙血量从 1000→900→800→…→100，而非直接到 0；\n// 2. 分布式锁（针对多服架构）：\n//- 若 SLG 采用 “分服 + 跨服” 架构（如联盟攻城涉及多个服务器的玩家），则需用 “分布式锁”（如基于 Redis 的 RedLock）锁定 “城墙” 这一实体，确保同一时间只有一个服务器能处理该实体的修改请求，避免多服并行修改冲突；\n// 3. 乐观锁与版本号校验：\n//- 为每个可修改实体（如城墙、资源点）添加 “状态版本号”（如 int 类型，初始为 1，每修改一次 + 1）；\n//- 客户端发起攻击请求时，需携带 “当前本地获取的实体版本号”（如客户端看到城墙版本号为 5，发起扣血请求时附带版本号 5）；\n//- 服务器处理请求前，先检查数据库中实体的当前版本号是否与客户端一致：\n// a. 一致：执行修改，版本号 + 1（变为 6），并将新状态和版本号下发给所有客户端；\n// b. 不一致（如其他客户端已修改过，版本号变为 6）：拒绝当前请求，向客户端下发最新状态，让客户端重新发起操作；\n// 4. 最终状态校验与修正：\n//- 每完成一轮并发操作（如 10 个玩家攻击结束），服务器计算实体的 “理论最终状态”（如城墙初始 1000 血，10 次扣 100，理论剩余 0），与数据库中实际状态对比；\n//- 若存在差异（如因网络延迟导致某请求未执行），则强制将数据库状态修正为理论值，并向所有客户端下发 “最终权威状态”，保证所有客户端一致。"}]},{"ID":"20250827205657-7ouqogx","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827205657-7ouqogx","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"问题 6：在 Unity 客户端开发中，即使服务器同步逻辑设计合理，仍可能因网络延迟（如 200ms 延迟）导致 “视觉体验问题”（如军队位置跳变、操作反馈滞后）。请说明你会通过哪些 Unity 客户端侧的优化手段，缓解这类同步体验问题？"}]},{"ID":"20250827205657-j370lhe","Type":"NodeParagraph","Properties":{"id":"20250827205657-j370lhe","updated":"20250827205657"},"Children":[{"Type":"NodeText","Data":"// 答案：核心思路是 “视觉补偿 + 预测插值 + 反馈优先”，具体 Unity 技术方案：\n// 1. 位置与旋转的平滑插值（解决跳变）：\n//- 服务器每 1-2 秒下发一次军队的 “目标位置”，客户端不直接将军队瞬移到目标位置，而是用 “Vector3.Lerp”（线性插值）或 “Vector3.SmoothDamp”（平滑阻尼）在 200ms 内逐步过渡到目标位置，视觉上避免跳变；\n//- 若军队处于移动中，客户端可基于服务器下发的 “移动方向 + 速度”，在两次同步间隔内 “预测移动路径”（如每帧按速度更新位置），服务器下次同步时若有偏差，再通过小幅度插值修正，减少修正感；\n//- 旋转同步同理：用 “Quaternion.Lerp” 平滑过渡军队朝向，避免突然转向；\n// 2. 输入反馈优先（解决操作滞后）：\n//- 玩家发起操作（如点击 “派遣军队”）时，客户端不等待服务器确认，先执行 “视觉反馈”（如军队播放 “出发动画”、弹出 “派遣中” 提示框），同时发送请求到服务器；\n//- 若服务器后续返回 “操作失败”（如资源不足），再通过 “友好提示”（如 “资源不足，派遣失败”）告知玩家，并回滚视觉效果（如军队回到初始位置），优先保证 “操作即时反馈”，降低延迟感；\n// 3. 动画与粒子效果的本地预播放（掩盖同步延迟）：\n//- 战斗场景中，客户端收到 “技能释放指令” 后，不等待服务器确认伤害结果，先本地播放 “技能动画 + 粒子效果”（如武将释放 “火攻”，先播放火焰粒子）；\n//- 服务器后续下发 “伤害结果” 后，再在动画关键帧（如火焰命中时）同步显示 “伤害数值”，让 “视觉表现” 与 “数据同步” 分离，避免 “等 0.2 秒才看到技能效果” 的卡顿；\n// 4. 网络状态可视化与动态适配：\n//- 在 UI 上添加 “网络延迟指示器”（如绿色 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"="}]},{"Type":"NodeText","Data":" 延迟 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":" 100ms，黄色 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"="}]},{"Type":"NodeText","Data":" 100-300ms，红色 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" 300ms），让玩家感知当前网络状态；\n//- 当延迟≥300ms 时，自动降低 “非关键视觉效果”（如关闭远处军队的细节模型、减少粒子发射数量），提升客户端帧率，避免延迟 + 卡顿的双重体验问题；\n// 5. 相机跟随的延迟补偿：\n//- 若玩家相机跟随军队移动，当军队因同步修正出现小幅度位置偏差时，相机不立即跟随修正，而是用 “LateUpdate” 中执行相机位置插值，确保相机移动平滑，进一步掩盖实体位置的微小修正。"}]},{"ID":"20250827234010-y70mlyg","Type":"NodeParagraph","Properties":{"id":"20250827234010-y70mlyg","updated":"20250827234010"}},{"ID":"20250827234010-3gnlbpw","Type":"NodeParagraph","Properties":{"id":"20250827234010-3gnlbpw","updated":"20250827234010"}},{"ID":"20250827234011-udyvxd1","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827234011-udyvxd1","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"问题 1：SLG 游戏包含 “多类型、高数量” 资源（如大地图纹理、武将模型、建筑预制体、技能特效），且需支持 “无缝大地图加载”，容易出现 “首次加载卡顿”“内存溢出” 问题。请说明你会如何设计 SLG 的资源管理架构（含加载、卸载、内存优化），同时保证大地图无缝加载体验？"}]},{"ID":"20250827234011-9npi1k5","Type":"NodeParagraph","Properties":{"id":"20250827234011-9npi1k5","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"// 答案：核心思路是 “分层加载 + 资源池复用 + 内存监控”，架构设计如下：\n// 一、资源分类与分层加载（解决首次加载卡顿）：\n// 1. 资源分类：按 “加载优先级” 将资源分为 3 类：\n//- 核心资源（必加载）：UI 预制体、主相机配置、网络协议脚本，游戏启动时同步加载（体积控制在 100MB 内）；\n//- 场景基础资源（按需加载）：大地图地形纹理（分块）、基础建筑模型（如城墙、资源点），进入对应地图区域时加载；\n//- 非核心资源（延迟加载）：武将皮肤、技能特效、背景音乐，玩家触发对应操作（如召唤武将、释放技能）时再加载，且加载时优先保证游戏逻辑运行；\n// 2. 大地图分块加载（无缝体验关键）：\n//- 将大地图按 “200x200 像素” 拆分为多个 “地形块”（Terrain Chunk），每个块作为独立资源包（AB 包）；\n//- 客户端基于 “玩家当前坐标” 计算 “视野内需要加载的块”（如当前块 + 周围 3 块缓冲），用 “异步加载（AsyncOperation）” 加载缓冲块，加载完成后自动拼接地形，卸载视野外 5 块以上的旧块；\n//- 加载过程中用 “低精度占位模型”（如简化的地形色块）替代未加载块，避免 “地形空白”，同时在 UI 显示 “加载进度条”（仅在加载时间 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" 500ms 时显示），降低玩家等待焦虑；\n// 二、资源卸载与内存优化（避免溢出）：\n// 1. 自动卸载策略：\n//- 未使用资源：通过 Unity 的 “Resources.UnloadUnusedAssets ()” 每 5 分钟执行一次，清理未被引用的 Asset（如已关闭的 UI 预制体、已销毁的特效）；\n//- 大体积临时资源：技能特效、临时武将模型等，在使用结束后（如特效播放完成、武将退出战斗）立即调用 “Destroy ()” 并标记为可卸载，避免长期占用内存；\n// 2. 资源压缩与格式优化：\n//- 纹理资源：用 ETC2 格式（移动端）替代 RGBA32，压缩比约 1:4；大地图纹理用 “mipmap”（多级渐远纹理），远处自动使用低分辨率纹理，降低显存占用；\n//- 模型资源：武将模型面数控制在 5000 面以内，删除冗余顶点；动画资源用 “动画片段剥离”，仅保留常用动画（如 idle、attack），删除未使用片段；\n// 3. 内存监控与预警：\n//- 集成 “Unity Profiler” 或自定义内存监控脚本，实时监控 “总内存占用”“显存占用”；\n//- 当内存占用超过设备阈值（如移动端超过 2GB）时，自动触发 “紧急卸载”：优先卸载非核心资源（如背景音乐、皮肤资源），若仍超标则降低大地图块加载精度（如减少缓冲块数量），避免游戏崩溃；\n// 三、资源池复用（减少加载开销）：\n//- 对高频创建 / 销毁的资源（如军队预制体、资源点模型），创建 “对象池”（Object Pool），初始化时预创建 10-20 个实例存入池中，需要时从池内获取，使用后放回池中，避免频繁 Instantiate/Destroy 导致的 GC（垃圾回收）卡顿；\n//- 池内实例未使用时，禁用 “MeshRenderer” 和 “Collider”，保留 Transform 等核心组件，减少性能消耗。"}]},{"ID":"20250827234011-wmqvz89","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827234011-wmqvz89","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"问题 2：SLG 游戏中 “资源产出与消耗” 是核心玩法（如粮食用于征兵、石料用于建城墙），需防止 “客户端作弊”（如篡改本地资源数量）和 “网络同步偏差”（如客户端显示粮食 1000，服务器实际为 800）。请说明你会如何设计 “资源数值同步与防作弊” 逻辑，确保资源数据的准确性？"}]},{"ID":"20250827234011-poqgkhu","Type":"NodeParagraph","Properties":{"id":"20250827234011-poqgkhu","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"// 答案：核心原则是 “服务器权威 + 客户端只读 + 校验机制”，具体设计：\n// 一、资源数值的服务器绝对管控（防作弊基础）：\n// 1. 客户端仅做 “展示与请求”，不参与计算：\n//- 客户端本地不存储 “资源当前数量” 的权威值，仅缓存 “服务器下发的展示值”，所有资源相关计算（如粮食产出、征兵消耗）均由服务器执行；\n//- 玩家发起资源消耗操作（如征兵 100，消耗粮食 200）时，客户端仅发送 “操作请求”（含操作类型、数量），不本地扣减资源，需等待服务器确认后，再更新展示值；\n// 2. 服务器资源数据持久化：\n//- 玩家资源数据（粮食、石料、金币等）实时写入数据库（如 MySQL+Redis 缓存），每笔资源变动（产出 / 消耗）记录 “操作日志”（含时间戳、操作类型、数值、发起 IP），便于后续查账与作弊追溯；\n//- 服务器定期（如每 10 分钟）对 Redis 缓存与数据库数据做一致性校验，避免缓存异常导致的数值偏差；\n// 二、防作弊校验机制（拦截非法操作）：\n// 1. 客户端请求合法性校验：\n//- 服务器收到资源消耗请求时，先校验 “是否满足消耗条件”（如征兵需粮食≥200、军营等级≥3），不满足则直接拒绝，返回 “条件不足” 提示；\n//- 对 “高频资源操作”（如 1 秒内发起 10 次征兵请求），触发 “频率限制”，临时封禁该玩家操作权限（如 10 秒内禁止征兵），防止脚本批量作弊；\n// 2. 数值合理性校验：\n//- 服务器对资源产出设置 “上限阈值”（如农田每小时最多产粮 1000，若某玩家 1 小时产粮 10 万），触发 “异常预警”，冻结该玩家资源账户，人工核查是否为作弊（如使用外挂修改产出速率）；\n//- 资源数量禁止出现 “负数”，服务器计算消耗时若发现 “消耗后数值 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":" 0”，直接终止操作，返回错误，避免客户端篡改请求参数（如将征兵消耗改为 - 200，试图增加粮食）；\n// 三、同步偏差修正（保证客户端展示准确）：\n//- 玩家每次上线 / 切换场景时，客户端主动向服务器请求 “最新资源快照”（含所有资源当前数量、产出速率），覆盖本地缓存值，解决 “离线期间资源变动导致的同步偏差”；\n//- 服务器每 30 秒向在线玩家 “推送一次资源同步包”（仅传输有变化的资源数值，如粮食从 800 增至 850，仅传粮食新值），实时修正客户端展示偏差，避免玩家看到 “假数值”。"}]},{"ID":"20250827234011-eayxkjv","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250827234011-eayxkjv","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"问题 3：SLG 大地图常需支持 “万人同屏”（如联盟集结、全服攻城），直接渲染所有玩家军队 / 城池会导致 “Draw Call 过高”“帧率暴跌”。请说明你会如何通过 Unity 图形优化技术，实现 “万人同屏” 的流畅渲染？"}]},{"ID":"20250827234011-kqxqkn1","Type":"NodeParagraph","Properties":{"id":"20250827234011-kqxqkn1","updated":"20250827234011"},"Children":[{"Type":"NodeText","Data":"// 答案：核心思路是 “批量渲染 + 层级简化 + 视距剔除”，具体优化方案：\n// 一、Draw Call 批量合并（降低渲染调用次数）：\n// 1. 静态实体（如城池、资源点）：\n//- 用 “Unity Static Batching” 将同材质的静态实体（如同一联盟的城池）合并为一个 “静态批次”，原本 100 个城池需 100 次 Draw Call，合并后仅需 1 次，大幅减少调用次数；\n//- 对大地图中 “重复出现的静态实体”（如中立资源点），使用 “Instancing（实例化渲染）”，通过 “GPU Instancing” 技术，用 1 次 Draw Call 渲染多个相同模型（仅传入不同位置、旋转参数），避免重复提交渲染指令；\n// 2. 动态实体（如玩家军队）：\n//- 用 “Dynamic Batching”（动态批处理）合并 “小模型、少顶点” 的动态实体（如军队模型面数 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":" 300），但需控制合并数量（单次合并不超过 100 个），避免批次过大导致的 CPU 开销；\n//- 对 “同类型、同材质” 的军队（如所有骑兵），使用 “SRP Batcher”（Scriptable Render Pipeline Batcher），基于材质实例 ID 批量管理渲染状态，减少材质切换导致的 Draw Call 增长（尤其适合 URP/HDRP 渲染管线）；\n// 二、模型与纹理层级简化（降低渲染负载）：\n// 1. LOD（Level of Detail，细节层次）技术：\n//- 为大地图实体（如军队、城池）制作 3-4 级 LOD 模型：\n// - LOD0（近距，"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003c"}]},{"Type":"NodeText","Data":"50 米）：高精度模型（5000 面）+ 高清纹理（2048x2048）；\n// - LOD1（中距，50-200 米）：中精度模型（2000 面）+ 中清纹理（1024x1024）；\n// - LOD2（远距，200-500 米）：低精度模型（500 面）+ 低清纹理（512x512）；\n// - LOD3（超远距，"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":"500 米）： Billboard（公告板，2D 面片），替代 3D 模型，仅渲染正面纹理；\n//- Unity 自动根据 “实体与相机的距离” 切换 LOD 层级，远距实体用低精度资源，降低 GPU 计算压力；\n// 2. 纹理压缩与图集合并：\n//- 所有实体纹理统一用 “ETC2”（移动端）或 “BC7”（PC 端）压缩格式，减少显存占用；\n//- 将 “小纹理”（如资源点图标、军队图标）合并为 “Sprite Atlas（精灵图集）”，减少纹理采样次数，同时避免单个小纹理的 Draw Call 浪费；\n// 三、视距剔除与遮挡剔除（减少渲染数量）：\n// 1. 视距剔除（Frustum Culling）：\n//- 开启 Unity 内置的 “视距剔除” 功能，仅渲染 “在相机视锥体范围内” 的实体，视锥体之外的实体（如相机背后、超远距离的军队）直接跳过渲染，减少无效渲染量；\n//- 对 “超远距离实体”（如 "},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"\u003e"}]},{"Type":"NodeText","Data":" 1000 米），直接从渲染队列中移除，仅在 UI 小地图上显示位置图标，不渲染 3D 模型；\n// 2. 遮挡剔除（Occlusion Culling）：\n//- 对大地图中的 “遮挡物”（如高山、大型城池），烘焙 “遮挡剔除数据”，当小实体（如军队）被遮挡物完全遮挡时（如军队在山后面），Unity 自动跳过该军队的渲染，避免 “渲染看不见的实体”；\n//- 注意：遮挡剔除适合静态遮挡物，动态遮挡物（如移动的大型武将）需配合 “动态遮挡检测” 脚本，实时判断是否被遮挡；\n// 四、渲染层与相机分层（灵活控制渲染范围）：\n//- 将大地图实体按 “重要性” 分渲染层（如 “玩家自身军队”“联盟军队”“敌方军队”“中立资源”）；\n//- 为相机设置 “渲染层过滤”，如 “攻城场景” 仅渲染 “玩家军队 + 敌方城池 + 联盟军队”，隐藏 “远处中立资源”，进一步减少渲染数量；\n//- 低配置设备（如安卓中端机）自动关闭 “非核心渲染层”（如敌方军队的 LOD0 层级），优先保证帧率。"}]},{"ID":"20250907231919-fkei5el","Type":"NodeParagraph","Properties":{"id":"20250907231919-fkei5el","updated":"20250907231919"}},{"ID":"20250908140944-gs1pnxl","Type":"NodeParagraph","Properties":{"id":"20250908140944-gs1pnxl","updated":"20250908140944"}},{"ID":"20250908140944-bor6ity","Type":"NodeParagraph","Properties":{"id":"20250908140944-bor6ity","updated":"20250908140944"}},{"ID":"20250908140945-pzl88j9","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908140945-pzl88j9","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"1. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"LZ4 压缩（推荐，Unity 5.3+ 支持）"}]},{"ID":"20250908140945-5rjz4c8","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-5rjz4c8","updated":"20250908140945"},"Children":[{"ID":"20250908140945-tdk9r51","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-tdk9r51","updated":"20250908140945"},"Children":[{"ID":"20250908140945-u637xag","Type":"NodeParagraph","Properties":{"id":"20250908140945-u637xag","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"压缩方式"},{"Type":"NodeText","Data":"​：块级压缩（Chunk-based Compression），将数据分成多个块单独压缩，支持​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"局部解压"},{"Type":"NodeText","Data":"​（加载时无需解压整个包，只需用哪部分解压哪部分）。"}]}]},{"ID":"20250908140945-qq628lg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-qq628lg","updated":"20250908140945"},"Children":[{"ID":"20250908140945-7g0uqbm","Type":"NodeParagraph","Properties":{"id":"20250908140945-7g0uqbm","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"特点"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908140945-7ldoidj","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-7ldoidj","updated":"20250908140945"},"Children":[{"ID":"20250908140945-nl3x5jc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-nl3x5jc","updated":"20250908140945"},"Children":[{"ID":"20250908140945-fvzv99q","Type":"NodeParagraph","Properties":{"id":"20250908140945-fvzv99q","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"压缩率中等（通常比未压缩小 30%-50%，略低于 LZMA）；"}]}]},{"ID":"20250908140945-ihg39kq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-ihg39kq","updated":"20250908140945"},"Children":[{"ID":"20250908140945-m6rquoc","Type":"NodeParagraph","Properties":{"id":"20250908140945-m6rquoc","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"加载速度快（局部解压，无需一次性解压整个包）；"}]}]},{"ID":"20250908140945-mqo8e8h","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-mqo8e8h","updated":"20250908140945"},"Children":[{"ID":"20250908140945-434v10x","Type":"NodeParagraph","Properties":{"id":"20250908140945-434v10x","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"运行时内存占用低（不解压完整数据到内存，按需读取）。"}]}]}]}]},{"ID":"20250908140945-6gj2el9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-6gj2el9","updated":"20250908140945"},"Children":[{"ID":"20250908140945-rxghpz9","Type":"NodeParagraph","Properties":{"id":"20250908140945-rxghpz9","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"适用场景"},{"Type":"NodeText","Data":"​：绝大多数需要平衡包体大小和加载速度的场景，尤其是移动端游戏（加载快、省内存）。"}]}]},{"ID":"20250908140945-l2tw6j1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-l2tw6j1","updated":"20250908140945"},"Children":[{"ID":"20250908140945-bc6ivok","Type":"NodeParagraph","Properties":{"id":"20250908140945-bc6ivok","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"使用方式"},{"Type":"NodeText","Data":"​：\ncsharp"}]},{"ID":"20250908140945-d2omvve","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250908140945-d2omvve","updated":"20250908140945"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 构建时指定压缩格式为 LZ4\nBuildPipeline.BuildAssetBundles(outputPath, BuildAssetBundleOptions.ChunkBasedCompression, targetPlatform);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250908140945-mlskpck","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908140945-mlskpck","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"2. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"LZMA 压缩（默认，Unity 早期版本）"}]},{"ID":"20250908140945-h7bra8k","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-h7bra8k","updated":"20250908140945"},"Children":[{"ID":"20250908140945-r15luhn","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-r15luhn","updated":"20250908140945"},"Children":[{"ID":"20250908140945-k4x6ptl","Type":"NodeParagraph","Properties":{"id":"20250908140945-k4x6ptl","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"压缩方式"},{"Type":"NodeText","Data":"​：整体压缩（Whole-file Compression），对整个 AB 包进行单一压缩，加载时"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"必须先完整解压到内存"},{"Type":"NodeText","Data":"才能使用。"}]}]},{"ID":"20250908140945-2sk0wok","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-2sk0wok","updated":"20250908140945"},"Children":[{"ID":"20250908140945-p832cso","Type":"NodeParagraph","Properties":{"id":"20250908140945-p832cso","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"特点"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908140945-omjs3ag","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-omjs3ag","updated":"20250908140945"},"Children":[{"ID":"20250908140945-e9d2l17","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-e9d2l17","updated":"20250908140945"},"Children":[{"ID":"20250908140945-9ne3xw7","Type":"NodeParagraph","Properties":{"id":"20250908140945-9ne3xw7","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"压缩率最高（比 LZ4 小 10%-20%）；"}]}]},{"ID":"20250908140945-mtj2vf0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-mtj2vf0","updated":"20250908140945"},"Children":[{"ID":"20250908140945-djz2t84","Type":"NodeParagraph","Properties":{"id":"20250908140945-djz2t84","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"加载速度慢（需完整解压，大文件可能导致卡顿）；"}]}]},{"ID":"20250908140945-vswnyq9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-vswnyq9","updated":"20250908140945"},"Children":[{"ID":"20250908140945-a7a4wy7","Type":"NodeParagraph","Properties":{"id":"20250908140945-a7a4wy7","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"运行时内存占用高（解压后完整数据驻留内存）。"}]}]}]}]},{"ID":"20250908140945-ufz3fm4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-ufz3fm4","updated":"20250908140945"},"Children":[{"ID":"20250908140945-pcpj61w","Type":"NodeParagraph","Properties":{"id":"20250908140945-pcpj61w","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"适用场景"},{"Type":"NodeText","Data":"​：包体大小优先于加载速度的场景，如资源下载（减少网络传输量）、不常用的冷资源。"}]}]},{"ID":"20250908140945-y602doy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-y602doy","updated":"20250908140945"},"Children":[{"ID":"20250908140945-fdc53u5","Type":"NodeParagraph","Properties":{"id":"20250908140945-fdc53u5","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"使用方式"},{"Type":"NodeText","Data":"​：\ncsharp"}]},{"ID":"20250908140945-1k0u16e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250908140945-1k0u16e","updated":"20250908140945"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 构建时不指定压缩选项，默认即为 LZMA\nBuildPipeline.BuildAssetBundles(outputPath, BuildAssetBundleOptions.None, targetPlatform);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250908140945-xcxops9","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908140945-xcxops9","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"3. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"未压缩（Uncompressed）"}]},{"ID":"20250908140945-ou5p764","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-ou5p764","updated":"20250908140945"},"Children":[{"ID":"20250908140945-3khrb68","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-3khrb68","updated":"20250908140945"},"Children":[{"ID":"20250908140945-5n0bpqv","Type":"NodeParagraph","Properties":{"id":"20250908140945-5n0bpqv","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"压缩方式"},{"Type":"NodeText","Data":"​：无任何压缩，数据直接存储。"}]}]},{"ID":"20250908140945-ou76w01","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-ou76w01","updated":"20250908140945"},"Children":[{"ID":"20250908140945-lzglhbg","Type":"NodeParagraph","Properties":{"id":"20250908140945-lzglhbg","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"特点"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908140945-chalkb7","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-chalkb7","updated":"20250908140945"},"Children":[{"ID":"20250908140945-9pky393","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-9pky393","updated":"20250908140945"},"Children":[{"ID":"20250908140945-kr8mnwu","Type":"NodeParagraph","Properties":{"id":"20250908140945-kr8mnwu","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"压缩率最低（包体最大）；"}]}]},{"ID":"20250908140945-dunck85","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-dunck85","updated":"20250908140945"},"Children":[{"ID":"20250908140945-yx9n8rj","Type":"NodeParagraph","Properties":{"id":"20250908140945-yx9n8rj","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"加载速度最快（无需解压，直接读取）；"}]}]},{"ID":"20250908140945-14kc5bx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-14kc5bx","updated":"20250908140945"},"Children":[{"ID":"20250908140945-1ntlzku","Type":"NodeParagraph","Properties":{"id":"20250908140945-1ntlzku","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"适合频繁访问的热资源（如主角模型、UI 图集）。"}]}]}]}]},{"ID":"20250908140945-wst2ryj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-wst2ryj","updated":"20250908140945"},"Children":[{"ID":"20250908140945-f5fvksx","Type":"NodeParagraph","Properties":{"id":"20250908140945-f5fvksx","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"适用场景"},{"Type":"NodeText","Data":"​：对加载速度要求极高的资源（如启动场景资源、战斗核心资源），或已通过其他方式压缩的资源（如本身已压缩的纹理、音频）。"}]}]},{"ID":"20250908140945-73t0zo4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-73t0zo4","updated":"20250908140945"},"Children":[{"ID":"20250908140945-iztdcb0","Type":"NodeParagraph","Properties":{"id":"20250908140945-iztdcb0","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"使用方式"},{"Type":"NodeText","Data":"​：\ncsharp"}]},{"ID":"20250908140945-mwvgwdl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250908140945-mwvgwdl","updated":"20250908140945"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Y3NoYXJw"},{"Type":"NodeCodeBlockCode","Data":"// 构建时指定不压缩\nBuildPipeline.BuildAssetBundles(outputPath, BuildAssetBundleOptions.UncompressedAssetBundle, targetPlatform);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20250908140945-4j6bly4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908140945-4j6bly4","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"4. "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"自定义压缩（第三方工具）"}]},{"ID":"20250908140945-n4mfu1n","Type":"NodeParagraph","Properties":{"id":"20250908140945-n4mfu1n","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"除 Unity 内置格式外，还可通过第三方工具对 AB 包进行二次压缩，常见方案："}]},{"ID":"20250908140945-qlxepzp","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-qlxepzp","updated":"20250908140945"},"Children":[{"ID":"20250908140945-f6i1l8u","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-f6i1l8u","updated":"20250908140945"},"Children":[{"ID":"20250908140945-3aejd7d","Type":"NodeParagraph","Properties":{"id":"20250908140945-3aejd7d","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"ZIP 压缩"},{"Type":"NodeText","Data":"​：用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"System.IO.Compression"},{"Type":"NodeText","Data":"​ 或第三方库（如 SharpZipLib）对 AB 包整体压缩，加载时先解压为内存流，再通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"AssetBundle.LoadFromMemory"},{"Type":"NodeText","Data":"​ 加载。"}]}]},{"ID":"20250908140945-pucf89p","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-pucf89p","updated":"20250908140945"},"Children":[{"ID":"20250908140945-kcldlrj","Type":"NodeParagraph","Properties":{"id":"20250908140945-kcldlrj","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"加密压缩"},{"Type":"NodeText","Data":"​：结合加密算法（如 AES）和压缩（如 LZ4），既减小包体又保护资源，适合防破解需求高的场景。"}]}]},{"ID":"20250908140945-scntm4b","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-scntm4b","updated":"20250908140945"},"Children":[{"ID":"20250908140945-lx61wph","Type":"NodeParagraph","Properties":{"id":"20250908140945-lx61wph","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"注意"},{"Type":"NodeText","Data":"​：自定义压缩需手动处理解压流程，增加代码复杂度，且可能无法利用 Unity 内置的加载优化（如 LZ4 的局部解压）。"}]}]}]},{"ID":"20250908140945-1vssoh0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908140945-1vssoh0","updated":"20250908145358"},"Children":[{"Type":"NodeText","Data":"压缩格式对比与选择建议"}]},{"ID":"20250908140945-whwla0h","Type":"NodeTable","TableAligns":[0,0,0,0,0],"Properties":{"colgroup":"||||","id":"20250908140945-whwla0h","updated":"20250908140945"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"格式"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"压缩率"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"加载速度"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"内存占用"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"适用场景"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"LZ4"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"中"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"快"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"低"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"绝大多数场景（平衡优先）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"LZMA"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"高"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"慢"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"高"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"下载包、冷资源（大小优先）"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"未压缩"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"低"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"最快"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"中"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"热资源、启动资源（速度优先）"}]}]}]},{"ID":"20250908140945-gh3ghtg","Type":"NodeParagraph","Properties":{"id":"20250908140945-gh3ghtg","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"最佳实践"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908140945-ugxnrp6","Type":"NodeList","ListData":{},"Properties":{"id":"20250908140945-ugxnrp6","updated":"20250908140945"},"Children":[{"ID":"20250908140945-rcjpb0f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-rcjpb0f","updated":"20250908140945"},"Children":[{"ID":"20250908140945-vyi24va","Type":"NodeParagraph","Properties":{"id":"20250908140945-vyi24va","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"移动端 / 性能敏感场景：优先用 ​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"LZ4"},{"Type":"NodeText","Data":"​；"}]}]},{"ID":"20250908140945-s26zt0g","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-s26zt0g","updated":"20250908140945"},"Children":[{"ID":"20250908140945-oe8vcxr","Type":"NodeParagraph","Properties":{"id":"20250908140945-oe8vcxr","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"资源包下载：用 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"LZMA"},{"Type":"NodeText","Data":" 减少流量；"}]}]},{"ID":"20250908140945-c2rfvyr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-c2rfvyr","updated":"20250908140945"},"Children":[{"ID":"20250908140945-etap6s0","Type":"NodeParagraph","Properties":{"id":"20250908140945-etap6s0","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"启动场景 / 高频访问资源：用 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"未压缩"},{"Type":"NodeText","Data":" 确保加载最快；"}]}]},{"ID":"20250908140945-mmllufj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908140945-mmllufj","updated":"20250908140945"},"Children":[{"ID":"20250908140945-q7lb05h","Type":"NodeParagraph","Properties":{"id":"20250908140945-q7lb05h","updated":"20250908140945"},"Children":[{"Type":"NodeText","Data":"避免混合使用多种格式（增加管理复杂度），同一类型资源尽量统一压缩策略。"}]}]}]},{"ID":"20250908145357-2hy160i","Type":"NodeParagraph","Properties":{"id":"20250908145357-2hy160i","updated":"20250908145357"}},{"ID":"20250908145357-4xgyjus","Type":"NodeParagraph","Properties":{"id":"20250908145357-4xgyjus","updated":"20250908145357"}},{"ID":"20250908145357-hto5089","Type":"NodeParagraph","Properties":{"id":"20250908145357-hto5089","updated":"20250908145357"}},{"ID":"20250908145358-vcr5acb","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908145358-vcr5acb","updated":"20250908145406"},"Children":[{"Type":"NodeText","Data":"一、活动数据的统一组织：抽象基类 + 类型适配"}]},{"ID":"20250908145358-bx56xuu","Type":"NodeParagraph","Properties":{"id":"20250908145358-bx56xuu","updated":"20250908145358"},"Children":[{"Type":"NodeText","Data":"通过 “​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"基类定义共性，子类实现特性"},{"Type":"NodeText","Data":"​” 的继承结构，统一管理不同活动的共性数据（如开启时间、状态）和个性数据（如签到进度、充值档位）。"}]},{"ID":"20250908145358-5roxj98","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250908145358-5roxj98","updated":"20250908145406"},"Children":[{"Type":"NodeText","Data":"1. 活动基类（抽象共性）"}]},{"ID":"20250908145358-vav9zhj","Type":"NodeParagraph","Properties":{"id":"20250908145358-vav9zhj","updated":"20250908145358"},"Children":[{"Type":"NodeText","Data":"定义所有活动共有的核心属性和方法，确保基础逻辑一致"}]},{"ID":"20250908145406-nwa4ad1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250908145406-nwa4ad1","updated":"20250908145415"},"Children":[{"Type":"NodeText","Data":"2. 活动子类（实现特性）"}]},{"ID":"20250908145406-3c3blfz","Type":"NodeParagraph","Properties":{"id":"20250908145406-3c3blfz","updated":"20250908145406"},"Children":[{"Type":"NodeText","Data":"每种活动类型继承基类，解析个性数据并实现专属逻辑"}]},{"ID":"20250908145414-vpuw89t","Type":"NodeParagraph","Properties":{"id":"20250908145414-vpuw89t","updated":"20250908145414"}},{"ID":"20250908145415-jc3kj84","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908145415-jc3kj84","updated":"20250908145428"},"Children":[{"Type":"NodeText","Data":"二、活动管理核心：ActivityManager 统一调度"}]},{"ID":"20250908145415-g70z987","Type":"NodeParagraph","Properties":{"id":"20250908145415-g70z987","updated":"20250908145415"},"Children":[{"Type":"NodeText","Data":"通过单例管理器统一管理所有活动的加载、更新、交互，对外提供简洁接口"}]},{"ID":"20250908145427-agcoid7","Type":"NodeParagraph","Properties":{"id":"20250908145427-agcoid7","updated":"20250908145427"}},{"ID":"20250908145428-boge85b","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908145428-boge85b","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"三、与服务器的交互设计"}]},{"ID":"20250908145428-iqvn1ld","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250908145428-iqvn1ld","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"1. 通信协议（示例）"}]},{"ID":"20250908145428-h6rwofi","Type":"NodeParagraph","Properties":{"id":"20250908145428-h6rwofi","updated":"20250908145444"},"Children":[{"Type":"NodeText","Data":"采用 SFSObject 格式通信，定义统一的请求 / 响应结构"}]},{"ID":"20250908145500-fbea11d","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20250908145500-fbea11d","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"2. 交互策略"}]},{"ID":"20250908145500-dsvrf48","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145500-dsvrf48","updated":"20250908145551"},"Children":[{"ID":"20250908145500-m0zs52t","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-m0zs52t","updated":"20250908145500"},"Children":[{"ID":"20250908145500-irhkggd","Type":"NodeParagraph","Properties":{"id":"20250908145500-irhkggd","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"数据同步时机"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145500-n64tsv3","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145500-n64tsv3","updated":"20250908145500"},"Children":[{"ID":"20250908145500-ubva2ij","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-ubva2ij","updated":"20250908145500"},"Children":[{"ID":"20250908145500-sbjdhyz","Type":"NodeParagraph","Properties":{"id":"20250908145500-sbjdhyz","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"客户端启动时全量拉取活动数据；"}]}]},{"ID":"20250908145500-b1im7x9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-b1im7x9","updated":"20250908145500"},"Children":[{"ID":"20250908145500-jn2u88f","Type":"NodeParagraph","Properties":{"id":"20250908145500-jn2u88f","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"活动操作（如签到、领奖）后，单独刷新该活动；"}]}]},{"ID":"20250908145500-y6e8m3s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-y6e8m3s","updated":"20250908145500"},"Children":[{"ID":"20250908145500-jywtsbd","Type":"NodeParagraph","Properties":{"id":"20250908145500-jywtsbd","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"定时轮询（如每 5 分钟）刷新进行中的活动（避免客户端时间偏差）；"}]}]},{"ID":"20250908145500-dv4xdwx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-dv4xdwx","updated":"20250908145500"},"Children":[{"ID":"20250908145500-8ueqvhc","Type":"NodeParagraph","Properties":{"id":"20250908145500-8ueqvhc","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"切换到活动界面时主动刷新（确保数据最新）。"}]}]}]}]},{"ID":"20250908145500-ezcw8sl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-ezcw8sl","updated":"20250908145500"},"Children":[{"ID":"20250908145500-12nc1ut","Type":"NodeParagraph","Properties":{"id":"20250908145500-12nc1ut","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"安全性处理"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145500-5dulep9","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145500-5dulep9","updated":"20250908145500"},"Children":[{"ID":"20250908145500-2k1pv6r","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-2k1pv6r","updated":"20250908145500"},"Children":[{"ID":"20250908145500-d62zkws","Type":"NodeParagraph","Properties":{"id":"20250908145500-d62zkws","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"所有关键操作（如领奖、充值）必须经过服务器校验（客户端校验仅用于提升体验）；"}]}]},{"ID":"20250908145500-qe0w9y7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-qe0w9y7","updated":"20250908145500"},"Children":[{"ID":"20250908145500-zlhfaax","Type":"NodeParagraph","Properties":{"id":"20250908145500-zlhfaax","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"服务器对活动时间、参与次数、奖励领取状态做最终判定；"}]}]},{"ID":"20250908145500-yewhqbs","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-yewhqbs","updated":"20250908145500"},"Children":[{"ID":"20250908145500-f6mu25k","Type":"NodeParagraph","Properties":{"id":"20250908145500-f6mu25k","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"敏感操作（如充值）需额外加签（防止数据篡改）。"}]}]}]}]},{"ID":"20250908145500-57yjdec","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-57yjdec","updated":"20250908145500"},"Children":[{"ID":"20250908145500-zpzwqqi","Type":"NodeParagraph","Properties":{"id":"20250908145500-zpzwqqi","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"异常处理"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145500-izo4g5k","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145500-izo4g5k","updated":"20250908145500"},"Children":[{"ID":"20250908145500-ccqn391","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-ccqn391","updated":"20250908145500"},"Children":[{"ID":"20250908145500-lsro2pd","Type":"NodeParagraph","Properties":{"id":"20250908145500-lsro2pd","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"网络请求超时自动重试（有限次数，如 3 次）；"}]}]},{"ID":"20250908145500-3sl75to","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-3sl75to","updated":"20250908145500"},"Children":[{"ID":"20250908145500-5ca1pm3","Type":"NodeParagraph","Properties":{"id":"20250908145500-5ca1pm3","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"服务器返回错误码时，客户端显示对应提示（如 “活动已结束”“今日已签到”）；"}]}]},{"ID":"20250908145500-qs48qp5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145500-qs48qp5","updated":"20250908145500"},"Children":[{"ID":"20250908145500-r67350f","Type":"NodeParagraph","Properties":{"id":"20250908145500-r67350f","updated":"20250908145500"},"Children":[{"Type":"NodeText","Data":"活动数据解析失败时，记录日志并隐藏该活动（避免界面崩溃）。"}]}]}]}]}]},{"ID":"20250908145557-uwqdj0g","Type":"NodeParagraph","Properties":{"id":"20250908145557-uwqdj0g","updated":"20250908145557"}},{"ID":"20250908145600-xmh74il","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20250908145600-xmh74il","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"四、扩展与维护"}]},{"ID":"20250908145600-xq7wh85","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250908145600-xq7wh85","updated":"20250908145600"},"Children":[{"ID":"20250908145600-a4lz8q3","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250908145600-a4lz8q3","updated":"20250908145600"},"Children":[{"ID":"20250908145600-yxghfdh","Type":"NodeParagraph","Properties":{"id":"20250908145600-yxghfdh","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"新增活动类型"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145600-iziri17","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145600-iziri17","updated":"20250908145600"},"Children":[{"ID":"20250908145600-lvkthuc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-lvkthuc","updated":"20250908145600"},"Children":[{"ID":"20250908145600-x57o8e6","Type":"NodeParagraph","Properties":{"id":"20250908145600-x57o8e6","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"新增"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ActivityType"},{"Type":"NodeText","Data":"​枚举值；"}]}]},{"ID":"20250908145600-lteiywn","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-lteiywn","updated":"20250908145600"},"Children":[{"ID":"20250908145600-9yyegtr","Type":"NodeParagraph","Properties":{"id":"20250908145600-9yyegtr","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"创建继承"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ActivityBase"},{"Type":"NodeText","Data":"​的子类，实现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"InitFromServerData"},{"Type":"NodeText","Data":"​和"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ExecuteOperation"},{"Type":"NodeText","Data":"​；"}]}]},{"ID":"20250908145600-h24n4ql","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-h24n4ql","updated":"20250908145600"},"Children":[{"ID":"20250908145600-ky0ab3i","Type":"NodeParagraph","Properties":{"id":"20250908145600-ky0ab3i","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"在"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ActivityManager"},{"Type":"NodeText","Data":"​中注册活动创建器；"}]}]},{"ID":"20250908145600-4mlmgit","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-4mlmgit","updated":"20250908145600"},"Children":[{"ID":"20250908145600-dkigpv1","Type":"NodeParagraph","Properties":{"id":"20250908145600-dkigpv1","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"前后端约定"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"extendData"},{"Type":"NodeText","Data":"​格式和操作类型。"}]}]}]}]},{"ID":"20250908145600-bzc6kmk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250908145600-bzc6kmk","updated":"20250908145600"},"Children":[{"ID":"20250908145600-jg38h2a","Type":"NodeParagraph","Properties":{"id":"20250908145600-jg38h2a","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"活动配置化"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145600-bswl9rq","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145600-bswl9rq","updated":"20250908145600"},"Children":[{"ID":"20250908145600-lpgdci7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-lpgdci7","updated":"20250908145600"},"Children":[{"ID":"20250908145600-mre1ghh","Type":"NodeParagraph","Properties":{"id":"20250908145600-mre1ghh","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"复杂活动（如多阶段任务）可通过 Excel 配置表定义规则（奖励、条件、时间），服务器加载配置，客户端按需拉取；"}]}]},{"ID":"20250908145600-kymva0w","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-kymva0w","updated":"20250908145600"},"Children":[{"ID":"20250908145600-7scypu4","Type":"NodeParagraph","Properties":{"id":"20250908145600-7scypu4","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"配置表示例："}]},{"ID":"20250908145600-xv89lce","Type":"NodeTable","TableAligns":[0,0,0,0,0,0],"Properties":{"colgroup":"|||||","id":"20250908145600-xv89lce","updated":"20250908145600"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"活动 ID"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"类型"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"开始时间"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"结束时间"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"每日奖励 ID"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"连续签到奖励"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"1001"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"1"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"..."}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"..."}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"10001,10002"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"7 天：20001"}]}]}]}]}]}]},{"ID":"20250908145600-sfvyb1t","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250908145600-sfvyb1t","updated":"20250908145600"},"Children":[{"ID":"20250908145600-126a57k","Type":"NodeParagraph","Properties":{"id":"20250908145600-126a57k","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"性能优化"},{"Type":"NodeText","Data":"​："}]},{"ID":"20250908145600-orgpmrr","Type":"NodeList","ListData":{},"Properties":{"id":"20250908145600-orgpmrr","updated":"20250908145600"},"Children":[{"ID":"20250908145600-5e03dvt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-5e03dvt","updated":"20250908145600"},"Children":[{"ID":"20250908145600-dcjfrgl","Type":"NodeParagraph","Properties":{"id":"20250908145600-dcjfrgl","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"不显示的活动（如未开启、已结束）仅保留基础数据，释放详细资源；"}]}]},{"ID":"20250908145600-nrgqage","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-nrgqage","updated":"20250908145600"},"Children":[{"ID":"20250908145600-gp0d8c1","Type":"NodeParagraph","Properties":{"id":"20250908145600-gp0d8c1","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"大量活动（如全服排行榜）采用分页拉取，避免一次性加载过多数据；"}]}]},{"ID":"20250908145600-a5ilmtc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20250908145600-a5ilmtc","updated":"20250908145600"},"Children":[{"ID":"20250908145600-pr1fhpo","Type":"NodeParagraph","Properties":{"id":"20250908145600-pr1fhpo","updated":"20250908145600"},"Children":[{"Type":"NodeText","Data":"活动 UI 采用对象池复用（如活动列表项），减少频繁创建销毁。"}]}]}]}]}]}]}